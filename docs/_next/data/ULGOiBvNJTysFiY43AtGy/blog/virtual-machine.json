{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var d=Object.create;var t=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var o=a=>t(a,\"__esModule\",{value:!0});var k=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),g=(a,s)=>{for(var l in s)t(a,l,{get:s[l],enumerable:!0})},i=(a,s,l,n)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let c of m(s))!N.call(a,c)&&(l||c!==\"default\")&&t(a,c,{get:()=>s[c],enumerable:!(n=h(s,c))||n.enumerable});return a},b=(a,s)=>i(o(t(a!=null?d(u(a)):{},\"default\",!s&&a&&a.__esModule?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a),f=(a=>(s,l)=>a&&a.get(s)||(l=i(o({}),s,1),a&&a.set(s,l),l))(typeof WeakMap!=\"undefined\"?new WeakMap:0);var p=k((F,r)=>{r.exports=_jsx_runtime});var x={};g(x,{default:()=>v,frontmatter:()=>y});var e=b(p()),y={title:\"Reversing MalwareTech 8-bit Bytecode Virtual Machine\",date:\"2021-12-07\",tags:[\"reverse\",\"malware\"],draft:!1,summary:\"Can you figure out how the VM works and write your own to decrypt the flag?\",layout:\"PostLayout\"};function w(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(l,{})})):l();function l(){let n=Object.assign({h1:\"h1\",a:\"a\",span:\"span\",p:\"p\",div:\"div\",strong:\"strong\",pre:\"pre\",code:\"code\",h2:\"h2\"},a.components),{Image:c}=n;return c||_(\"Image\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h1,{id:\"challenge-description\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#challenge-description\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Challenge description.\"]}),(0,e.jsx)(n.p,{children:\"vm1.exe implements a simple 8-bit virtual machine (VM) to try and stop reverse engineers from retrieving the flag. The VM\\u2019s RAM contains the encrypted flag and some bytecode to decrypt it. Can you figure out how the VM works and write your own to decrypt the flag? A copy of the VM\\u2019s RAM has been provided in ram.bin (this data is identical to the ram content of the malware\\u2019s VM before execution and contains both the custom assembly code and encrypted flag).\"}),(0,e.jsxs)(n.h1,{id:\"introduction\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#introduction\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Introduction\"]}),(0,e.jsx)(n.p,{children:\"Main function analysis\"}),(0,e.jsx)(n.div,{children:(0,e.jsx)(c,{alt:\"Main Function\",src:\"/static/images/mal/vmq.png\",width:\"659\",height:\"385\"})}),(0,e.jsxs)(n.p,{children:[\"From the above image the \",(0,e.jsx)(n.strong,{children:\"HeapAlloc\"}),\" function allocates a block of memory from a heap. Heapalloc function above,allocates a memory block of size \",(0,e.jsx)(n.strong,{children:\"0x1FB\"}),\" bytes. The pointer of the allocated memory block is called allocated_memblock as shown in the image.\"]}),(0,e.jsxs)(n.p,{children:[\"The program does a \",(0,e.jsx)(n.strong,{children:\"memcpy\"}),\" of the content stored in the rambin offset to the new allocated memory block.\"]}),(0,e.jsx)(n.pre,{className:\"language-c\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-c\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"memcpy\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"dest\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"src\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"size_t\"}),\" count\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})})}),(0,e.jsx)(n.p,{children:\"Memcpy functions copies data from the source address to destination address of size 0x1fb. The destination address of this program is the allocate_memblock. Examining the bytes in the rambin file provided as part of the challenge and the content at rambin offset are the same as shown in the image below.\"}),(0,e.jsx)(n.div,{children:(0,e.jsx)(c,{alt:\"Rambin\",src:\"/static/images/mal/rambin.png\",width:\"540\",height:\"309\"})}),(0,e.jsxs)(n.p,{children:[\"Next step is to analyze the \",(0,e.jsx)(n.strong,{children:\"sub_4022E0\"}),\" function. The disassembled function graph looks like the one below.\"]}),(0,e.jsx)(n.div,{children:(0,e.jsx)(c,{alt:\"sub_4022E0 control flow loop\",src:\"/static/images/mal/vmflow.png\",width:\"549\",height:\"636\"})}),(0,e.jsxs)(n.p,{children:[\"From the disassembly above, the binary is doing some byte operations. The first graph block is doing a bitwise AND operation, which is responsible for setting both SF and ZF to zero.First it sets the value of eax register to 1, and then do a test operation. Because the conditional \",(0,e.jsx)(n.strong,{children:'\"jump if zero\"'}),\" is not true, we continue our execution to the next control block.\"]}),(0,e.jsx)(n.p,{children:\"We do decompilation of the function using NSA ghidra tool.The decompiled of the function is shown below.\"}),(0,e.jsx)(n.pre,{className:\"language-c\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-c\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"FUN_004022e0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  byte bVar1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  uint uVar2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  byte bVar3\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  byte counter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  \n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  counter \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"do\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"/* 0 */\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    uVar2 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"uint\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"counter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"/* 2 */\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    bVar1 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" counter \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    bVar3 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" counter \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    counter \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" counter \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    uVar2 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"FUN_00402270\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"uint\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"byte \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"allocated_memblock \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0xff\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" uVar2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                         \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"uint\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"byte \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"allocated_memblock \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0xff\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"uint\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"bVar1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                         \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"uint\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"byte \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"allocated_memblock \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0xff\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"uint\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"bVar3\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"while\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"uVar2 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"&\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0xff\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" uVar2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"The above c-code like is more easier to understand than the assembly code. From the analysis of the code, we are doing a while loop.The assembly equivalent of this operation is as the one shown in the first memory block of the function.\"}),(0,e.jsx)(n.pre,{className:\"language-nasm\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-nasm\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function label\",children:\"loc_4022EA:\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"mov     \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"eax\"}),\", \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"test    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"eax\"}),\", \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"eax\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`jz      short loc_402367\n`})]})}),(0,e.jsxs)(n.p,{children:[\"Therefore, we call the function \",(0,e.jsx)(n.strong,{children:\"FUN_00402270\"}),\" while passing three arguments.The control graph below shows various operation executed by the binary depending on the argument passed to the function.\"]}),(0,e.jsx)(n.div,{children:(0,e.jsx)(c,{alt:\"control flow loop\",src:\"/static/images/mal/vmflow2.png\",width:\"1119\",height:\"646\"})}),(0,e.jsx)(n.p,{children:\"From the above graph, the function does a compare on the arguments passed with either 1, 2 or 3. If the condition is fulfilled, that operation branch is executed as shown in the image above.\"}),(0,e.jsxs)(n.p,{children:[\"Example: \",(0,e.jsx)(n.strong,{children:\"if the argument value passed is 1, control flow branch to loc_4022E address as shown in the graph\"})]}),(0,e.jsxs)(n.p,{children:[\"For better understanding of the control flow, we decompile the function using ghidra, because \",(0,e.jsx)(n.strong,{children:\"idafree\"}),' does not support x86 decompilation.The \"C-like style\" of the code looks like the one below.']}),(0,e.jsx)(n.pre,{className:\"language-c\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-c\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"FUN_00402270\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" value1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" value2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" param_3\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"value1 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"undefined \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"allocated_memblock \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" value2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"undefined\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"param_3\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"value1 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      value1 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" allocated_memblock \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" value2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      DAT_00404240 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"byte \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"value1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"value1 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" value1 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"&\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0xffffff00\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      value1 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" allocated_memblock \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" value2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"byte \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"allocated_memblock \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" value2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"byte \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"value1 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"^\"}),\" DAT_00404240\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"CONCAT31\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"int3\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"uint\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"value1 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\">>\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"The decompilation output of ghidra is not optimal, therefore decompiled code contains some cast which can be fixed by setting the correct data types in the functional signatures of the function.Because this is an easy VM, we can implement the above code in a python3 script in order to decrypt the contents of \",(0,e.jsx)(n.strong,{children:\"ram.bin\"}),\" file.\"]}),(0,e.jsxs)(n.h2,{id:\"solution\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#solution\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Solution\"]}),(0,e.jsx)(n.p,{children:\"Fully implemented solution code is below.\"}),(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-python\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"#implement decryption routine function in python\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"#solution.py\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"fun_00402270\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"value1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" value2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" value3\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"global\"}),` dat_420\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" value1 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        membytes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"value2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),` value3 \n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"elif\"}),\" value1 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        dat_420 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" membytes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"value2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"else\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" value1 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            membytes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"value2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" membytes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"value2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"^\"}),` dat_420\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"else\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"False\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"True\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" __name__ \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"__main__\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"global\"}),` membytes\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    membytes \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    \n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#open the encypted file and read bytes\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"with\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"open\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'ram.bin'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'rb'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),\" rambin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        membytes\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"list\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"rambin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"read\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    counter  \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    uvar2 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    bvar1 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    bvar3 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    uvar2_response \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"True\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"while\"}),\" uvar2_response\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        counter \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        uvar2_response \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" fun_00402270\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"membytes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"counter\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0xff\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" uvar2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" membytes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"counter\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0xff\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" bvar1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" membytes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"counter\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0xff\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" bvar3\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"chr\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"x\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" x \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" membytes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"26\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`})]})}),(0,e.jsx)(n.p,{children:\"Running the above script in the terminal gets us our flag\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`vx@archie:vm$ python3 x.py \n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'F'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'L'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'A'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'G'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'{'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'V'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'M'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'S'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'-'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'A'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'R'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'E'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'-'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'F'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'O'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'R'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'-'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'M'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'A'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'L'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'W'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'A'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'R'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'E'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'}'\"}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"After a successful decryption of the rambin contents, the \",(0,e.jsx)(n.code,{children:\"sub_4022E0\"}),\" function return the pointer to the flag to main function as shown in the image below.\"]}),(0,e.jsx)(n.div,{children:(0,e.jsx)(c,{alt:\"Return value of sub_4022E0\",src:\"/static/images/mal/retflag.png\",width:\"486\",height:\"240\"})}),(0,e.jsxs)(n.p,{children:[\"Therefore the main function calculates the MD5 hash of the flag and outputs to the message dialogbox using \",(0,e.jsx)(n.strong,{children:\"MessageBoxA\"}),\" function.\"]}),(0,e.jsxs)(n.p,{children:[\"The correct flag for the vm challenge is \",(0,e.jsx)(n.code,{children:\"FLAG{VMS-ARE-FOR-MALWARE}\"})]})]})}}var v=w;function _(a,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return f(x);})();\n;return Component;","toc":[{"value":"Challenge description.","url":"#challenge-description","depth":1},{"value":"Introduction","url":"#introduction","depth":1},{"value":"Solution","url":"#solution","depth":2}],"frontMatter":{"readingTime":{"text":"7 min read","minutes":6.75,"time":405000,"words":1350},"slug":"virtual-machine","fileName":"virtual-machine.mdx","title":"Reversing MalwareTech 8-bit Bytecode Virtual Machine","date":"2021-12-07","tags":["reverse","malware"],"draft":false,"summary":"Can you figure out how the VM works and write your own to decrypt the flag?","layout":"PostLayout"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.54,"time":32400,"words":108},"slug":["default"],"fileName":"default.md","name":"Thuri","avatar":"/static/images/avatar.png","occupation":"Software Developer","email":"thuri783@gmail.com","github":"https://github.com/thuri10"}],"prev":{"title":"Android Application Security Series - Part2","date":"2021-10-25T00:00:00.000Z","draft":false,"tags":["Android","Appsec"],"summary":"Firebase, Local Sqlite and AWS storage security weaknesses.","images":["/static/images/android/firebase.jpg"],"slug":"android-security-part2"},"next":{"title":"Static Analysis of Malware Strings","date":"2021-12-07T00:00:00.000Z","tags":["malware","reverse"],"draft":false,"summary":"Strings challenges contains an un-encrypted flag stored within the executable. When run, the program will output an MD5 hash of the flag but not the original. Can you extract the flag?","images":[],"layout":"PostLayout","slug":"strings-malware"}},"__N_SSG":true}