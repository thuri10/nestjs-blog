{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var d=Object.create;var c=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var f=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var p=(i,a)=>()=>(a||i((a={exports:{}}).exports,a),a.exports),y=(i,a)=>{for(var s in a)c(i,s,{get:a[s],enumerable:!0})},o=(i,a,s,n)=>{if(a&&typeof a==\"object\"||typeof a==\"function\")for(let t of u(a))!m.call(i,t)&&t!==s&&c(i,t,{get:()=>a[t],enumerable:!(n=h(a,t))||n.enumerable});return i};var x=(i,a,s)=>(s=i!=null?d(f(i)):{},o(a||!i||!i.__esModule?c(s,\"default\",{value:i,enumerable:!0}):s,i)),b=i=>o(c({},\"__esModule\",{value:!0}),i);var l=p((T,r)=>{r.exports=_jsx_runtime});var I={};y(I,{default:()=>v,frontmatter:()=>g});var e=x(l()),g={title:\"Reversing c++ - Basic Templates\",date:\"2022-07-16\",tags:[\"Reverse\",\"OpenSecurity\",\"c++\"],draft:!1,summary:\"C++ Basic Templates\",images:\"/static/images/ost2/basictemplates.png\",layout:\"PostLayout\",canonicalUrl:null};function w(i={}){let{wrapper:a}=i.components||{};return a?(0,e.jsx)(a,Object.assign({},i,{children:(0,e.jsx)(s,{})})):s();function s(){let n=Object.assign({h1:\"h1\",a:\"a\",span:\"span\",blockquote:\"blockquote\",p:\"p\",code:\"code\",h2:\"h2\",h3:\"h3\",div:\"div\",ol:\"ol\",li:\"li\"},i.components),{Image:t}=n;return t||k(\"Image\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h1,{id:\"the-calcnum-lab\",children:[(0,e.jsx)(n.a,{href:\"#the-calcnum-lab\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"The CalcNum Lab\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"In this exercise you will need to reverse engineer a binary, research different functions, and understand if the functions are part of a template or not.\"})}),(0,e.jsxs)(n.p,{children:[\"NB: \",(0,e.jsx)(n.code,{children:\"Decompilers are not permitted, please use only static reverse engineering during this lab.\"})]}),(0,e.jsxs)(n.p,{children:[\"The lab can be downloaded at the following link \",(0,e.jsx)(n.a,{href:\"https://gitlab.com/opensecuritytraining/re3011_cpp_re_binaries/-/blob/main/CalcNum%C2%A0\",children:\"CalcNum lab\"})]}),(0,e.jsxs)(n.h2,{id:\"what-is-a-c-template\",children:[(0,e.jsx)(n.a,{href:\"#what-is-a-c-template\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"What is a C++ template?\"]}),(0,e.jsx)(n.p,{children:\"A Template is a c++ entity that accepts different data types but performs the same functionality. The data types are passed as template parameters to template function so that we don't need to write same code functionality for different data types.\"}),(0,e.jsxs)(n.h2,{id:\"lab-analysis\",children:[(0,e.jsx)(n.a,{href:\"#lab-analysis\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Lab Analysis\"]}),(0,e.jsx)(n.p,{children:\"For solving the questions, I used an approach of first reading questions and then reverse engineering those functions only. This ensured I only reversed functions important to our analysis.\"}),(0,e.jsxs)(n.h2,{id:\"question-1\",children:[(0,e.jsx)(n.a,{href:\"#question-1\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Question 1\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"Which of the the following functions are part of the same template?\"})}),(0,e.jsxs)(n.p,{children:[\"For reverse engineering we will focus on the following functions, \",(0,e.jsx)(n.code,{children:\"0x1229\"}),\", \",(0,e.jsx)(n.code,{children:\"0x1620\"}),\", \",(0,e.jsx)(n.code,{children:\"0x1342\"}),\", \",(0,e.jsx)(n.code,{children:\"0x15fa\"}),\", and \",(0,e.jsx)(n.code,{children:\"0x1245\"}),\" in order to answer the first and subsequent questions.\"]}),(0,e.jsx)(n.p,{children:\"The first step to manually reverse functions and understand what each function is doing. For analysis I will be using IDA Pro freeware.\"}),(0,e.jsxs)(n.h3,{id:\"0x1229-function-analysis\",children:[(0,e.jsx)(n.a,{href:\"#0x1229-function-analysis\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),(0,e.jsx)(n.code,{children:\"0x1229\"}),\" Function Analysis\"]}),(0,e.jsx)(n.div,{children:(0,e.jsx)(t,{alt:\"Subtraction\",src:\"/static/images/ost2/sub_func1.png\",width:\"605\",height:\"384\"})}),(0,e.jsxs)(n.p,{children:[\"Looking at the function as shown in image above, it accepts two parameters of type \",(0,e.jsx)(n.code,{children:\"int\"}),\" and does Subtraction (assembly instruction\",(0,e.jsx)(n.code,{children:\"sub\"}),\") of local variables \",(0,e.jsx)(n.code,{children:\"x\"}),\" and \",(0,e.jsx)(n.code,{children:\"y\"}),\" ant then returns the result. The return value is of type \",(0,e.jsx)(n.code,{children:\"int\"}),\", therefore we can set type of our function as shown in the image above.\"]}),(0,e.jsxs)(n.h3,{id:\"0x1620-function-analysis\",children:[(0,e.jsx)(n.a,{href:\"#0x1620-function-analysis\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),(0,e.jsx)(n.code,{children:\"0x1620\"}),\" Function Analysis\"]}),(0,e.jsx)(n.div,{children:(0,e.jsx)(t,{alt:\"Max value\",src:\"/static/images/ost2/max_func.png\",width:\"758\",height:\"579\"})}),(0,e.jsxs)(n.p,{children:[\"From the analysis of this function, it accepts two parameters of type \",(0,e.jsx)(n.code,{children:\"long\"}),\" and finds the maximum value between the two. The two parameters are compared through use of \",(0,e.jsx)(n.code,{children:\"jge\"}),\" assembly instruction as shown above.\"]}),(0,e.jsxs)(n.h3,{id:\"0x1342-function-analysis\",children:[(0,e.jsx)(n.a,{href:\"#0x1342-function-analysis\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),(0,e.jsx)(n.code,{children:\"0x1342\"}),\" Function Analysis\"]}),(0,e.jsx)(n.div,{children:(0,e.jsx)(t,{alt:\"Max value\",src:\"/static/images/ost2/func3.png\",width:\"758\",height:\"579\"})}),(0,e.jsxs)(n.p,{children:[\"The function accepts two parameters of type \",(0,e.jsx)(n.code,{children:\"long\"}),\" and checks if one parameter is equal to \",(0,e.jsx)(n.code,{children:\"zero\"}),\". If the value is not equal to \",(0,e.jsx)(n.code,{children:\"zero\"}),\", it does math and bit operations.\"]}),(0,e.jsxs)(n.h3,{id:\"0x15fa-function-analysis\",children:[(0,e.jsx)(n.a,{href:\"#0x15fa-function-analysis\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),(0,e.jsx)(n.code,{children:\"0x15fa\"}),\" Function Analysis\"]}),(0,e.jsx)(n.div,{children:(0,e.jsx)(t,{alt:\"Max value\",src:\"/static/images/ost2/max_value2.png\",width:\"758\",height:\"579\"})}),(0,e.jsxs)(n.p,{children:[\"From the analysis of this function, function accepts two parameters of type \",(0,e.jsx)(n.code,{children:\"int\"}),\" and finds the maximum value between the two. The two parameters are compared through use of \",(0,e.jsx)(n.code,{children:\"jge\"}),\" assembly instruction. Therefore the maximum value is returned by the function.\"]}),(0,e.jsxs)(n.h3,{id:\"0x1245-function-analysis\",children:[(0,e.jsx)(n.a,{href:\"#0x1245-function-analysis\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),(0,e.jsx)(n.code,{children:\"0x1245\"}),\" Function Analysis\"]}),(0,e.jsx)(n.div,{children:(0,e.jsx)(t,{alt:\"0x1245 analysis\",src:\"/static/images/ost2/func4.png\",width:\"643\",height:\"579\"})}),(0,e.jsxs)(n.p,{children:[\"This function takes four parameters of type \",(0,e.jsx)(n.code,{children:\"int\"}),\" and does further bits operations as shown in the disassembly code.\"]}),(0,e.jsxs)(n.p,{children:[\"From the above functions analysis, only two functions qualify as templates. \",(0,e.jsx)(n.code,{children:\"0x1620\"}),\" and \",(0,e.jsx)(n.code,{children:\"0x15fa\"}),\" are templates functions because they perform the same functionality( \",(0,e.jsx)(n.code,{children:\"Finding the Maximum value\"}),\") and number of parameters passed to each function are the same.\"]}),(0,e.jsxs)(n.h2,{id:\"question-2\",children:[(0,e.jsx)(n.a,{href:\"#question-2\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Question 2\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsxs)(n.p,{children:[\"Review the function at address \",(0,e.jsx)(n.code,{children:\"0x12C5\"}),\" and other functions in the binary. Is this function a template function?\"]})}),(0,e.jsxs)(n.h3,{id:\"0x12c5-function-analysis\",children:[(0,e.jsx)(n.a,{href:\"#0x12c5-function-analysis\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),(0,e.jsx)(n.code,{children:\"0x12C5\"}),\" Function Analysis\"]}),(0,e.jsx)(n.div,{children:(0,e.jsx)(t,{alt:\"0x12c5 analysis\",src:\"/static/images/ost2/func5.png\",width:\"620\",height:\"497\"})}),(0,e.jsxs)(n.p,{children:[\"This function does the same functionality as the function \",(0,e.jsx)(n.code,{children:\"0x1245\"}),\", but the difference is the unequal number of parameters passed to each function. Therefore, it does \",(0,e.jsx)(n.code,{children:\"not\"}),\" qualify as a template function.\"]}),(0,e.jsxs)(n.h2,{id:\"question-3\",children:[(0,e.jsx)(n.a,{href:\"#question-3\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Question 3\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsxs)(n.p,{children:[\"Review the function at address \",(0,e.jsx)(n.code,{children:\"0x15cc\"}),\" and the function at address \",(0,e.jsx)(n.code,{children:\"0x15fa\"}),\". Are these functions part of the same template function?\"]})}),(0,e.jsxs)(n.h3,{id:\"0x15cc-function-analysis\",children:[(0,e.jsx)(n.a,{href:\"#0x15cc-function-analysis\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),(0,e.jsx)(n.code,{children:\"0x15cc\"}),\" Function Analysis\"]}),(0,e.jsx)(n.p,{children:\"This function is used for calculating minimum value of the two parameters passed to function.\"}),(0,e.jsx)(n.div,{children:(0,e.jsx)(t,{alt:\"0x15cc analysis\",src:\"/static/images/ost2/min_value.png\",width:\"814\",height:\"553\"})}),(0,e.jsxs)(n.p,{children:[\"The two functions are \",(0,e.jsx)(n.code,{children:\"not\"}),\" of the same template function. This is because one is used for calculating the maximum value and other one for minimum value. The difference between the two is \",(0,e.jsx)(n.code,{children:\"jge\"}),\" and \",(0,e.jsx)(n.code,{children:\"jle\"}),\" conditional assembly instructions as shown in IDA disassembly above.\"]}),(0,e.jsxs)(n.h2,{id:\"references\",children:[(0,e.jsx)(n.a,{href:\"#references\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"References\"]}),(0,e.jsx)(n.ol,{children:(0,e.jsxs)(n.li,{children:[\"C++ Templates Basics - \",(0,e.jsx)(n.a,{href:\"https://m.cplusplus.com/doc/oldtutorial/templates/\",children:\"https://m.cplusplus.com/doc/oldtutorial/templates/\"})]})})]})}}var v=w;function k(i,a){throw new Error(\"Expected \"+(a?\"component\":\"object\")+\" `\"+i+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return b(I);})();\n;return Component;","toc":[{"value":"The CalcNum Lab","url":"#the-calcnum-lab","depth":1},{"value":"What is a C++ template?","url":"#what-is-a-c-template","depth":2},{"value":"Lab Analysis","url":"#lab-analysis","depth":2},{"value":"Question 1","url":"#question-1","depth":2},{"value":"0x1229 Function Analysis","url":"#0x1229-function-analysis","depth":3},{"value":"0x1620 Function Analysis","url":"#0x1620-function-analysis","depth":3},{"value":"0x1342 Function Analysis","url":"#0x1342-function-analysis","depth":3},{"value":"0x15fa Function Analysis","url":"#0x15fa-function-analysis","depth":3},{"value":"0x1245 Function Analysis","url":"#0x1245-function-analysis","depth":3},{"value":"Question 2","url":"#question-2","depth":2},{"value":"0x12C5 Function Analysis","url":"#0x12c5-function-analysis","depth":3},{"value":"Question 3","url":"#question-3","depth":2},{"value":"0x15cc Function Analysis","url":"#0x15cc-function-analysis","depth":3},{"value":"References","url":"#references","depth":2}],"frontMatter":{"readingTime":{"text":"4 min read","minutes":3.055,"time":183300,"words":611},"slug":"reversing-c-basic-templates","fileName":"reversing-c-basic-templates.mdx","title":"Reversing c++ - Basic Templates","date":"2022-07-16","tags":["Reverse","OpenSecurity","c++"],"draft":false,"summary":"C++ Basic Templates","images":"/static/images/ost2/basictemplates.png","layout":"PostLayout","canonicalUrl":null}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.53,"time":31800,"words":106},"slug":["default"],"fileName":"default.md","name":"Thuri","avatar":"/static/images/profile.png","occupation":"Software Developer","email":"thuri783@gmail.com","github":"https://github.com/thuri10"}],"prev":{"title":"Analyzing Malware packets using gopackets","date":"2022-04-20T00:00:00.000Z","tags":["golang","packets","networking"],"draft":false,"summary":"Analyzing malware packets using gopackets","images":"/static/images/packets/packet.jpg","layout":"PostLayout","canonicalUrl":null,"slug":"golangpackets"},"next":{"title":"Insecureshop - Weak Host Validation Check","date":"2022-07-23T00:00:00.000Z","tags":["android","appsec","insecureshop"],"draft":false,"summary":"Weak Host Validation Check","images":"/static/images/insecureshop/validate.png","layout":"PostLayout","canonicalUrl":null,"slug":"insecureshop-weak-host-validation-check"}},"__N_SSG":true}