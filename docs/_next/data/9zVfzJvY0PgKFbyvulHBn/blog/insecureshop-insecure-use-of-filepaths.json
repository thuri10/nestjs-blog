{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var p=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty;var N=(e,s)=>()=>(s||e((s={exports:{}}).exports,s),s.exports),k=(e,s)=>{for(var t in s)l(e,t,{get:s[t],enumerable:!0})},i=(e,s,t,n)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let c of u(s))!h.call(e,c)&&c!==t&&l(e,c,{get:()=>s[c],enumerable:!(n=d(s,c))||n.enumerable});return e};var g=(e,s,t)=>(t=e!=null?p(m(e)):{},i(s||!e||!e.__esModule?l(t,\"default\",{value:e,enumerable:!0}):t,e)),f=e=>i(l({},\"__esModule\",{value:!0}),e);var r=N((F,o)=>{o.exports=_jsx_runtime});var P={};k(P,{default:()=>q,frontmatter:()=>v});var a=g(r()),v={title:\"Insecureshop - 11. Insecure use of FilePaths\",date:\"2022-07-23\",tags:[\"android\",\"appsec\",\"insecureshop\"],draft:!0,summary:\"Insecure use of FilePaths in FileProvider\",images:\"/static/images/insecureshop/filepath.jpg\",layout:\"PostLayout\",canonicalUrl:null};function x(e={}){let{wrapper:s}=e.components||{};return s?(0,a.jsx)(s,Object.assign({},e,{children:(0,a.jsx)(t,{})})):t();function t(){let n=Object.assign({h1:\"h1\",a:\"a\",span:\"span\",blockquote:\"blockquote\",p:\"p\",pre:\"pre\",code:\"code\"},e.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.h1,{id:\"insecure-use-of-filepaths-in-fileprovider\",children:[(0,a.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#insecure-use-of-filepaths-in-fileprovider\",tabIndex:\"-1\",children:(0,a.jsx)(n.span,{className:\"icon icon-link\"})}),\"Insecure use of FilePaths in FileProvider\"]}),(0,a.jsx)(n.blockquote,{children:(0,a.jsx)(n.p,{children:\"The use of wide file sharing declaration can be used to access root directory via content Provider.\"})}),(0,a.jsx)(n.pre,{className:\"language-xml\",children:(0,a.jsxs)(n.code,{className:\"language-xml code-highlight\",children:[(0,a.jsxs)(n.span,{className:\"code-line\",children:[(0,a.jsxs)(n.span,{className:\"token tag\",children:[(0,a.jsxs)(n.span,{className:\"token tag\",children:[(0,a.jsx)(n.span,{className:\"token punctuation\",children:\"<\"}),\"provider\"]}),\" \",(0,a.jsxs)(n.span,{className:\"token attr-name\",children:[(0,a.jsx)(n.span,{className:\"token namespace\",children:\"android:\"}),\"name\"]}),(0,a.jsxs)(n.span,{className:\"token attr-value\",children:[(0,a.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"androidx.core.content.FileProvider\",(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),\" \",(0,a.jsxs)(n.span,{className:\"token attr-name\",children:[(0,a.jsx)(n.span,{className:\"token namespace\",children:\"android:\"}),\"exported\"]}),(0,a.jsxs)(n.span,{className:\"token attr-value\",children:[(0,a.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"false\",(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),\" \",(0,a.jsxs)(n.span,{className:\"token attr-name\",children:[(0,a.jsx)(n.span,{className:\"token namespace\",children:\"android:\"}),\"authorities\"]}),(0,a.jsxs)(n.span,{className:\"token attr-value\",children:[(0,a.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"com.insecureshop.file_provider\",(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),\" \",(0,a.jsxs)(n.span,{className:\"token attr-name\",children:[(0,a.jsx)(n.span,{className:\"token namespace\",children:\"android:\"}),\"grantUriPermissions\"]}),(0,a.jsxs)(n.span,{className:\"token attr-value\",children:[(0,a.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"true\",(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),(0,a.jsx)(n.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,a.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,a.jsxs)(n.span,{className:\"token tag\",children:[(0,a.jsxs)(n.span,{className:\"token tag\",children:[(0,a.jsx)(n.span,{className:\"token punctuation\",children:\"<\"}),\"meta-data\"]}),\" \",(0,a.jsxs)(n.span,{className:\"token attr-name\",children:[(0,a.jsx)(n.span,{className:\"token namespace\",children:\"android:\"}),\"name\"]}),(0,a.jsxs)(n.span,{className:\"token attr-value\",children:[(0,a.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"android.support.FILE_PROVIDER_PATHS\",(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),\" \",(0,a.jsxs)(n.span,{className:\"token attr-name\",children:[(0,a.jsx)(n.span,{className:\"token namespace\",children:\"android:\"}),\"resource\"]}),(0,a.jsxs)(n.span,{className:\"token attr-value\",children:[(0,a.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"@xml/provider_paths\",(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),(0,a.jsx)(n.span,{className:\"token punctuation\",children:\"/>\"})]}),`\n`]}),(0,a.jsxs)(n.span,{className:\"code-line\",children:[(0,a.jsxs)(n.span,{className:\"token tag\",children:[(0,a.jsxs)(n.span,{className:\"token tag\",children:[(0,a.jsx)(n.span,{className:\"token punctuation\",children:\"</\"}),\"provider\"]}),(0,a.jsx)(n.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]})]})}),(0,a.jsx)(n.p,{children:\"the path application grants\"}),(0,a.jsx)(n.pre,{className:\"language-xml\",children:(0,a.jsxs)(n.code,{className:\"language-xml code-highlight\",children:[(0,a.jsxs)(n.span,{className:\"code-line\",children:[(0,a.jsx)(n.span,{className:\"token prolog\",children:'<?xml version=\"1.0\" encoding=\"utf-8\"?>'}),`\n`]}),(0,a.jsxs)(n.span,{className:\"code-line\",children:[(0,a.jsxs)(n.span,{className:\"token tag\",children:[(0,a.jsxs)(n.span,{className:\"token tag\",children:[(0,a.jsx)(n.span,{className:\"token punctuation\",children:\"<\"}),\"paths\"]}),\" \",(0,a.jsxs)(n.span,{className:\"token attr-name\",children:[(0,a.jsx)(n.span,{className:\"token namespace\",children:\"xmlns:\"}),\"android\"]}),(0,a.jsxs)(n.span,{className:\"token attr-value\",children:[(0,a.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"http://schemas.android.com/apk/res/android\",(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),(0,a.jsx)(n.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,a.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,a.jsxs)(n.span,{className:\"token tag\",children:[(0,a.jsxs)(n.span,{className:\"token tag\",children:[(0,a.jsx)(n.span,{className:\"token punctuation\",children:\"<\"}),\"root-path\"]}),\" \",(0,a.jsx)(n.span,{className:\"token attr-name\",children:\"name\"}),(0,a.jsxs)(n.span,{className:\"token attr-value\",children:[(0,a.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"root\",(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),\" \",(0,a.jsx)(n.span,{className:\"token attr-name\",children:\"path\"}),(0,a.jsxs)(n.span,{className:\"token attr-value\",children:[(0,a.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"/\",(0,a.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),(0,a.jsx)(n.span,{className:\"token punctuation\",children:\"/>\"})]}),`\n`]}),(0,a.jsxs)(n.span,{className:\"code-line\",children:[(0,a.jsxs)(n.span,{className:\"token tag\",children:[(0,a.jsxs)(n.span,{className:\"token tag\",children:[(0,a.jsx)(n.span,{className:\"token punctuation\",children:\"</\"}),\"paths\"]}),(0,a.jsx)(n.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,a.jsx)(n.span,{className:\"code-line\",children:`\n`})]})})]})}}var q=x;return f(P);})();\n;return Component;","toc":[{"value":"Insecure use of FilePaths in FileProvider","url":"#insecure-use-of-filepaths-in-fileprovider","depth":1}],"frontMatter":{"readingTime":{"text":"1 min read","minutes":0.87,"time":52200,"words":174},"slug":"insecureshop-insecure-use-of-filepaths","fileName":"insecureshop-insecure-use-of-filepaths.mdx","title":"Insecureshop - 11. Insecure use of FilePaths","date":"2022-07-23","tags":["android","appsec","insecureshop"],"draft":true,"summary":"Insecure use of FilePaths in FileProvider","images":"/static/images/insecureshop/filepath.jpg","layout":"PostLayout","canonicalUrl":null}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.53,"time":31800,"words":106},"slug":["default"],"fileName":"default.md","name":"Thuri","avatar":"/static/images/profile.png","occupation":"Software Developer","email":"thuri783@gmail.com","github":"https://github.com/thuri10"}],"prev":{"title":"Insecureshop - Insecure Logging","date":"2022-07-23T00:00:00.000Z","tags":["android","appsec","insecureshop"],"draft":false,"summary":"Insecure Logging for Credentials","images":"/static/images/insecureshop/logging.jpg","layout":"PostLayout","canonicalUrl":null,"slug":"insecureshop-19-insecure-logging"},"next":null},"__N_SSG":true}