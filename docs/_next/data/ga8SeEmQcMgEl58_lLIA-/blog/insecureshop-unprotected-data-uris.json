{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var r=Object.create;var c=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var l=e=>c(e,\"__esModule\",{value:!0});var m=(e,s)=>()=>(s||e((s={exports:{}}).exports,s),s.exports),N=(e,s)=>{l(e);for(var t in s)c(e,t,{get:s[t],enumerable:!0})},k=(e,s,t)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let a of d(s))!u.call(e,a)&&a!==\"default\"&&c(e,a,{get:()=>s[a],enumerable:!(t=p(s,a))||t.enumerable});return e},g=e=>k(l(c(e!=null?r(h(e)):{},\"default\",e&&e.__esModule&&\"default\"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var o=m((x,i)=>{i.exports=_jsx_runtime});var b={};N(b,{default:()=>y,frontmatter:()=>f});var n=g(o()),f={title:\"Insecureshop - Unprotected Data URIs\",date:\"2022-07-23\",tags:[\"android\",\"appsec\",\"insecureshop\"],draft:!0,summary:\"Unprotected Data URIs\",images:[],layout:\"PostLayout\",canonicalUrl:null};function w(e={}){let{wrapper:s}=e.components||{};return s?(0,n.jsx)(s,Object.assign({},e,{children:(0,n.jsx)(t,{})})):t();function t(){let a=Object.assign({h1:\"h1\",a:\"a\",span:\"span\",blockquote:\"blockquote\",p:\"p\",code:\"code\",pre:\"pre\",ol:\"ol\",li:\"li\"},e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.h1,{id:\"unprotected-data-uris\",children:[(0,n.jsx)(a.a,{href:\"#unprotected-data-uris\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"Unprotected Data URIs\"]}),(0,n.jsx)(a.blockquote,{children:(0,n.jsxs)(a.p,{children:[\"The \",(0,n.jsx)(a.code,{children:\"com.insecureshop.WebView2Activity\"}),\" contains the following code. The code takes untrusted URL in loadUrl method and passes it to webview.\"]})}),(0,n.jsxs)(a.p,{children:[\"First is to analyze the Android manifest file for \",(0,n.jsx)(a.code,{children:\"com.insecureshop.WebView2Activity\"})]}),(0,n.jsx)(a.pre,{className:\"language-xml\",children:(0,n.jsxs)(a.code,{className:\"code-highlight language-xml\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),\"activity\"]}),\" \",(0,n.jsxs)(a.span,{className:\"token attr-name\",children:[(0,n.jsx)(a.span,{className:\"token namespace\",children:\"android:\"}),\"name\"]}),(0,n.jsxs)(a.span,{className:\"token attr-value\",children:[(0,n.jsx)(a.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'}),\"com.insecureshop.WebView2Activity\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),\"intent-filter\"]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),\"action\"]}),\" \",(0,n.jsxs)(a.span,{className:\"token attr-name\",children:[(0,n.jsx)(a.span,{className:\"token namespace\",children:\"android:\"}),\"name\"]}),(0,n.jsxs)(a.span,{className:\"token attr-value\",children:[(0,n.jsx)(a.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'}),\"com.insecureshop.action.WEBVIEW\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"/>\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),\"category\"]}),\" \",(0,n.jsxs)(a.span,{className:\"token attr-name\",children:[(0,n.jsx)(a.span,{className:\"token namespace\",children:\"android:\"}),\"name\"]}),(0,n.jsxs)(a.span,{className:\"token attr-value\",children:[(0,n.jsx)(a.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'}),\"android.intent.category.DEFAULT\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"/>\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),\"category\"]}),\" \",(0,n.jsxs)(a.span,{className:\"token attr-name\",children:[(0,n.jsx)(a.span,{className:\"token namespace\",children:\"android:\"}),\"name\"]}),(0,n.jsxs)(a.span,{className:\"token attr-value\",children:[(0,n.jsx)(a.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'}),\"android.intent.category.BROWSABLE\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"/>\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"</\"}),\"intent-filter\"]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsxs)(a.span,{className:\"token tag\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"</\"}),\"activity\"]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]})]})}),(0,n.jsx)(a.p,{children:\"Analyze webview2 activity to understand the risks\"}),(0,n.jsx)(a.pre,{className:\"language-java\",children:(0,n.jsxs)(a.code,{className:\"code-highlight language-java\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" dataString \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" intent\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getDataString\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\"!\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"dataString \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"null\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"||\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"StringsKt\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"isBlank\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"dataString\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Intent\"}),\" intent2 \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"getIntent\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Intrinsics\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"checkExpressionValueIsNotNull\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"intent2\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"intent\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        webview\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"loadUrl\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"intent2\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getDataString\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(a.h1,{id:\"references\",children:[(0,n.jsx)(a.a,{href:\"#references\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"References\"]}),(0,n.jsx)(a.ol,{children:(0,n.jsx)(a.li,{children:(0,n.jsx)(a.a,{href:\"https://www.mbsd.jp/Whitepaper/IntentScheme.pdf\",children:\"https://www.mbsd.jp/Whitepaper/IntentScheme.pdf\"})})})]})}}var y=w;return b;})();\n;return Component;","toc":[{"value":"Unprotected Data URIs","url":"#unprotected-data-uris","depth":1},{"value":"References","url":"#references","depth":1}],"frontMatter":{"readingTime":{"text":"2 min read","minutes":1.105,"time":66300,"words":221},"slug":"insecureshop-unprotected-data-uris","fileName":"insecureshop-unprotected-data-uris.mdx","title":"Insecureshop - Unprotected Data URIs","date":"2022-07-23","tags":["android","appsec","insecureshop"],"draft":true,"summary":"Unprotected Data URIs","images":[],"layout":"PostLayout","canonicalUrl":null}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.535,"time":32100,"words":107},"slug":["default"],"fileName":"default.md","name":"Thuri","avatar":"/static/images/profile.png","occupation":"Software Developer","email":"thuri783@gmail.com","github":"https://github.com/thuri10"}],"prev":{"title":"Insecureshop - Hardcoded Credentials","date":"2022-07-23T00:00:00.000Z","tags":["Android","Insecureshop","mobile","appsec"],"draft":false,"summary":"Identify username and password that is hardcoded in the app","images":"/static/images/insecureshop/hardcoded.png","layout":"PostLayout","canonicalUrl":null,"slug":"insecureshop-hardcoded-credentials"},"next":null},"__N_SSG":true}