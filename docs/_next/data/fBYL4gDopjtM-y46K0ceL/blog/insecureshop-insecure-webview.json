{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var p=Object.create;var i=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var N=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),k=(a,s)=>{for(var c in s)i(a,c,{get:s[c],enumerable:!0})},l=(a,s,c,e)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let t of h(s))!m.call(a,t)&&t!==c&&i(a,t,{get:()=>s[t],enumerable:!(e=d(s,t))||e.enumerable});return a};var w=(a,s,c)=>(c=a!=null?p(u(a)):{},l(s||!a||!a.__esModule?i(c,\"default\",{value:a,enumerable:!0}):c,a)),b=a=>l(i({},\"__esModule\",{value:!0}),a);var r=N((y,o)=>{o.exports=_jsx_runtime});var x={};k(x,{default:()=>f,frontmatter:()=>g});var n=w(r()),g={title:\"Insecureshop - Insecure Webview\",date:\"2022-07-23\",tags:[\"android\",\"appsec\",\"insecureshop\"],draft:!1,summary:\"Insecure Webview Properties Enabled\",images:\"/static/images/insecureshop/webview1.jpg\",layout:\"PostLayout\",canonicalUrl:null};function v(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({h1:\"h1\",a:\"a\",span:\"span\",blockquote:\"blockquote\",p:\"p\",code:\"code\",h2:\"h2\",h3:\"h3\",pre:\"pre\",ol:\"ol\",li:\"li\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h1,{id:\"insecure-webview-properties-enabled\",children:[(0,n.jsx)(e.a,{href:\"#insecure-webview-properties-enabled\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Insecure Webview Properties Enabled\"]}),(0,n.jsx)(e.blockquote,{children:(0,n.jsxs)(e.p,{children:[\"The activity \",(0,n.jsx)(e.code,{children:\"com.insecureshop.WebViewActivity\"}),\", \",(0,n.jsx)(e.code,{children:\"com.insecureshop.WebView2Activity\"}),\" and \",(0,n.jsx)(e.code,{children:\"com.insecureshop.PrivateActivity\"}),\" have the following insecure WebView properties enabled\"]})}),(0,n.jsxs)(e.h2,{id:\"what-is-webview\",children:[(0,n.jsx)(e.a,{href:\"#what-is-webview\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"What is webview?\"]}),(0,n.jsx)(e.p,{children:\"Webview is a view that displays web pages inside you application. This enables extension of the application functionality by loading the HTML content.\"}),(0,n.jsxs)(e.h3,{id:\"views-analysis\",children:[(0,n.jsx)(e.a,{href:\"#views-analysis\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Views analysis\"]}),(0,n.jsx)(e.p,{children:\"The code snippet below applies to all the WebSettings of all the webviews.\"}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"WebView\"}),\" webview \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"WebView\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"findViewById\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"R\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"webview\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Intrinsics\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"checkExpressionValueIsNotNull\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"webview\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"webview\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"WebSettings\"}),\" settings \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" webview\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"getSettings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Intrinsics\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"checkExpressionValueIsNotNull\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"settings\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"webview.settings\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    settings\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"setJavaScriptEnabled\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"WebSettings\"}),\" settings2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" webview\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"getSettings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Intrinsics\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"checkExpressionValueIsNotNull\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"settings2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"webview.settings\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    settings2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"setLoadWithOverviewMode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"WebSettings\"}),\" settings3 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" webview\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"getSettings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Intrinsics\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"checkExpressionValueIsNotNull\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"settings3\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"webview.settings\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    settings3\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"setUseWideViewPort\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"WebSettings\"}),\" settings4 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" webview\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"getSettings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Intrinsics\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"checkExpressionValueIsNotNull\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"settings4\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"webview.settings\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    settings4\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"setAllowUniversalAccessFromFileURLs\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"WebSettings\"}),\" settings5 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" webview\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"getSettings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Intrinsics\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"checkExpressionValueIsNotNull\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"settings5\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"webview.settings\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    settings5\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"setUserAgentString\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"USER_AGENT\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    webview\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"setWebViewClient\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"CustomWebViewClient\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"Looking at the above code, various dangerous web settings are enabled.\"}),(0,n.jsxs)(e.ol,{children:[(0,n.jsx)(e.li,{children:(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"setJavaScriptEnabled\"}),\" - This enables an attacker to execute arbitrary code within this webview to perform malicious actions.\"]})}),(0,n.jsx)(e.li,{children:(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"setAllowUniversalAccessFromFileURLs\"}),\" - This enables an attacker to load arbitrary URL into a webview.Therefore an attacker can load the URL into a webview to steal the user cookies or access the application files.\"]})})]}),(0,n.jsx)(e.p,{children:\"To prevent these vulnerabilities, or reduce the impact do validation of the URL loaded and javascript that is to be executed.\"}),(0,n.jsxs)(e.h2,{id:\"references\",children:[(0,n.jsx)(e.a,{href:\"#references\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"References\"]}),(0,n.jsx)(e.ol,{children:(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://pentestlab.blog/2017/02/12/android-webview-vulnerabilities/\",children:\"https://pentestlab.blog/2017/02/12/android-webview-vulnerabilities/\"})})})]})}}var f=v;return b(x);})();\n;return Component;","toc":[{"value":"Insecure Webview Properties Enabled","url":"#insecure-webview-properties-enabled","depth":1},{"value":"What is webview?","url":"#what-is-webview","depth":2},{"value":"Views analysis","url":"#views-analysis","depth":3},{"value":"References","url":"#references","depth":2}],"frontMatter":{"readingTime":{"text":"2 min read","minutes":1.83,"time":109800,"words":366},"slug":"insecureshop-insecure-webview","fileName":"insecureshop-insecure-webview.mdx","title":"Insecureshop - Insecure Webview","date":"2022-07-23","tags":["android","appsec","insecureshop"],"draft":false,"summary":"Insecure Webview Properties Enabled","images":"/static/images/insecureshop/webview1.jpg","layout":"PostLayout","canonicalUrl":null}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.53,"time":31800,"words":106},"slug":["default"],"fileName":"default.md","name":"Thuri","avatar":"/static/images/profile.png","occupation":"Software Developer","email":"thuri783@gmail.com","github":"https://github.com/thuri10"}],"prev":{"title":"Reversing c++ - Basic Templates","date":"2022-07-16T00:00:00.000Z","tags":["Reverse","OpenSecurity","c++"],"draft":false,"summary":"C++ Basic Templates","images":"/static/images/ost2/basictemplates.png","layout":"PostLayout","canonicalUrl":null,"slug":"reversing-c-basic-templates"},"next":{"title":"Insecureshop - Hardcoded Credentials","date":"2022-07-23T00:00:00.000Z","tags":["Android","Insecureshop","mobile","appsec"],"draft":false,"summary":"Identify username and password that is hardcoded in the app","images":"/static/images/insecureshop/hardcoded.png","layout":"PostLayout","canonicalUrl":null,"slug":"insecureshop-hardcoded-credentials"}},"__N_SSG":true}