---
title: Insecureshop - Unprotected Data URIs
date: '2022-07-23'
tags: ['android', 'appsec', 'insecureshop']
draft: true
summary: Unprotected Data URIs
images: []
layout: PostLayout
canonicalUrl:
---

# Unprotected Data URIs

> The `com.insecureshop.WebView2Activity` contains the following code. The code takes untrusted URL in loadUrl method and passes it to webview.

First is to analyze the Android manifest file for `com.insecureshop.WebView2Activity`

```xml
<activity android:name="com.insecureshop.WebView2Activity">
    <intent-filter>
        <action android:name="com.insecureshop.action.WEBVIEW"/>
        <category android:name="android.intent.category.DEFAULT"/>
        <category android:name="android.intent.category.BROWSABLE"/>
    </intent-filter>
</activity>
```

Analyze webview2 activity to understand the risks


```java
String dataString = intent.getDataString();
    if (!(dataString == null || StringsKt.isBlank(dataString))) {
        Intent intent2 = getIntent();
        Intrinsics.checkExpressionValueIsNotNull(intent2, "intent");
        webview.loadUrl(intent2.getDataString());
        return;
    }
```


# References
1. https://www.mbsd.jp/Whitepaper/IntentScheme.pdf

