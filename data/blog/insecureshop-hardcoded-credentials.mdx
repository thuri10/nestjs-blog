---
title: Insecureshop - Hardcoded Credentials
date: '2022-07-23'
tags: ['Android', 'Insecureshop', 'mobile', 'appsec']
draft: false
summary: Identify username and password that is hardcoded in the app
images: '/static/images/insecureshop/hardcoded.png'
layout: PostLayout
canonicalUrl:
---

# Hardcoded Credentials

> Credentials are hardcoded somewhere that can be used to login to the application

First step for static analysis is to identify the activity responsible for login the application.`com.insecureshop.LoginActivity` which is defined in the Android Manifest file is the activity responsible for login logic.

For understanding the authentication flow of the application, we decompile the application using `Jadx` and open decompiled code using `vscode`.

For Decompilation, run the following command with various flags as command line arguments.

```bash
jadx -d insecure/ --deobf-parse-kotlin-metadata --rename-flags valid --use-dx InsecureShop.apk
```

Looking at the code below, the login activity expects a username and password. If the password and username provided are true, the application will load the products context as shown in code snippet below.

```java
 String username = String.valueOf(textInputEditText.getText());
    ActivityLoginBinding activityLoginBinding2 = this.mBinding;
    if (activityLoginBinding2 == null) {
        Intrinsics.throwUninitializedPropertyAccessException("mBinding");
    }
    TextInputEditText textInputEditText2 = activityLoginBinding2.edtPassword;
    Intrinsics.checkExpressionValueIsNotNull(textInputEditText2, "mBinding.edtPassword");
    String password = String.valueOf(textInputEditText2.getText());
    Log.d("userName", username);
    Log.d("password", password);
    boolean auth = Util.INSTANCE.verifyUserNamePassword(username, password);
    if (auth) {
        Prefs prefs = Prefs.INSTANCE;
        Context applicationContext = getApplicationContext();
```

Next step is understanding the `verifyUserNamePassword` functionality.

```java
 public final boolean verifyUserNamePassword(String username, String password) {
        Intrinsics.checkParameterIsNotNull(username, "username");
        Intrinsics.checkParameterIsNotNull(password, "password");
        if (!getUserCreds().containsKey(username)) {
            return false;
        }
        String passwordValue = getUserCreds().get(username);
        return StringsKt.equals$default(passwordValue, password, false, 2, null);
    }
```

The function receives two parameters ( username and password) of type string and check if they are `NULL`. If condition is false, it calls the `getUserCreds()` function in which it checks the supplied credentials with hardcoded ones.

```java
  private final HashMap<String, String> getUserCreds() {
        HashMap userCreds = new HashMap();
        userCreds.put("shopuser", "!ns3csh0p");
        return userCreds;
    }

```

The above function stores the username and password as "username/password" pairs in an array. The hardcoded credentials can now be used to login as `shopuser`.

Using `shopuser` and `!ns3csh0p` we are able to login to the application successfully.

To mitigate the above vulnerability, store credentials in a secure cryptographic place like `keystore` in android or `keychain` in iOS ecosystem.
