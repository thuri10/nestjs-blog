<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.2.0">

<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css" integrity="sha256-xejo6yLi6vGtAjcMIsY8BHdKsLg7QynVlFMzdQgUuy8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"thuri10.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":true,"version":"8.12.3","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"default"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="In this exercise you will need to reverse engineer a binary, research different functions, and understand if the functions are part of a template or not.">
<meta property="og:type" content="blog">
<meta property="og:title" content="Reversing C++ basic templates">
<meta property="og:url" content="http://thuri10.github.io/2022/07/16/Reverse-C-Templates/index.html">
<meta property="og:site_name" content="LaByte">
<meta property="og:description" content="In this exercise you will need to reverse engineer a binary, research different functions, and understand if the functions are part of a template or not.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://thuri10.github.io/images/ost2/sub_func1.png">
<meta property="og:image" content="http://thuri10.github.io/images/ost2/max_func.png">
<meta property="og:image" content="http://thuri10.github.io/images/ost2/func3.png">
<meta property="og:image" content="http://thuri10.github.io/images/ost2/max_value2.png">
<meta property="og:image" content="http://thuri10.github.io/images/ost2/func4.png">
<meta property="og:image" content="http://thuri10.github.io/images/ost2/func5.png">
<meta property="og:image" content="http://thuri10.github.io/images/ost2/min_value.png">
<meta property="article:published_time" content="2022-07-16T20:21:04.000Z">
<meta property="article:modified_time" content="2022-09-23T10:12:15.885Z">
<meta property="article:author" content="Thuri">
<meta property="article:tag" content="reverse">
<meta property="article:tag" content="opensecurity">
<meta property="article:tag" content="c++">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://thuri10.github.io/images/ost2/sub_func1.png">


<link rel="canonical" href="http://thuri10.github.io/2022/07/16/Reverse-C-Templates/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://thuri10.github.io/2022/07/16/Reverse-C-Templates/","path":"2022/07/16/Reverse-C-Templates/","title":"Reversing C++ basic templates"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Reversing C++ basic templates | LaByte</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">LaByte</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Messing Bits</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#What-is-a-C-template"><span class="nav-text">What is a C++ template?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Lab-Analysis"><span class="nav-text">Lab Analysis</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Question-1"><span class="nav-text">Question 1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#0x1229-Function-Analysis"><span class="nav-text">0x1229 Function Analysis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x1620-Function-Analysis"><span class="nav-text">0x1620 Function Analysis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x1342-Function-Analysis"><span class="nav-text">0x1342 Function Analysis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x15fa-Function-Analysis"><span class="nav-text">0x15fa Function Analysis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x1245-Function-Analysis"><span class="nav-text">0x1245 Function Analysis</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Question-2"><span class="nav-text">Question 2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#0x12C5-Function-Analysis"><span class="nav-text">0x12C5 Function Analysis</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Question-3"><span class="nav-text">Question 3</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#0x15cc-Function-Analysis"><span class="nav-text">0x15cc Function Analysis</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#References"><span class="nav-text">References</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Thuri</p>
  <div class="site-description" itemprop="description">Messy Bits</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/thuri10" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;thuri10" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:thuri783@gmail.com" title="E-Mail → mailto:thuri783@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/0xhexski" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;0xhexski" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://thuri10.github.io/2022/07/16/Reverse-C-Templates/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Thuri">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LaByte">
      <meta itemprop="description" content="Messy Bits">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Reversing C++ basic templates | LaByte">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Reversing C++ basic templates
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: July 16 2022 23:21:04" itemprop="dateCreated datePublished" datetime="2022-07-16T23:21:04+03:00">July 16 2022</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <blockquote>
<p>In this exercise you will need to reverse engineer a binary, research different functions, and understand if the functions are part of a template or not. <span id="more"></span></p>
</blockquote>
<p><strong>NB: Decompilers are not permitted, please use only static reverse engineering during this lab.</strong></p>
<p>The lab can be downloaded at the following link <a target="_blank" rel="noopener" href="https://gitlab.com/opensecuritytraining/re3011_cpp_re_binaries/-/blob/main/CalcNum%C2%A0">CalcNum lab</a></p>
<h2 id="What-is-a-C-template"><a href="#What-is-a-C-template" class="headerlink" title="What is a C++ template?"></a>What is a C++ template?</h2><p>A Template is a c++ entity that accepts different data types but performs the same functionality. The data types are passed as template parameters to template function so that we don’t need to write same code functionality for different data types.</p>
<h2 id="Lab-Analysis"><a href="#Lab-Analysis" class="headerlink" title="Lab Analysis"></a>Lab Analysis</h2><p>For solving the questions, I used an approach of first reading questions and then reverse engineering those functions only. This ensured I only reversed functions important to our analysis.</p>
<h2 id="Question-1"><a href="#Question-1" class="headerlink" title="Question 1"></a>Question 1</h2><blockquote>
<p>Which of the the following functions are part of the same template?</p>
</blockquote>
<p>For reverse engineering we will focus on the following functions, <code>0x1229</code>, <code>0x1620</code>, <code>0x1342</code>, <code>0x15fa</code>, and <code>0x1245</code> in order to answer the first and subsequent questions.</p>
<p>The first step to manually reverse functions and understand what each function is doing.<br>For analysis I will be using IDA Pro freeware.</p>
<h3 id="0x1229-Function-Analysis"><a href="#0x1229-Function-Analysis" class="headerlink" title="0x1229 Function Analysis"></a><code>0x1229</code> Function Analysis</h3><p><img data-src="/images/ost2/sub_func1.png" alt="Subtraction"></p>
<p>Looking at the function as shown in image above, it accepts two parameters of type <code>int</code> and does Subtraction (assembly instruction<code>sub</code>) of local variables <code>x</code> and <code>y</code> ant then returns the result. The return value is of type <code>int</code>, therefore we can set type of our function as shown in the image above.</p>
<h3 id="0x1620-Function-Analysis"><a href="#0x1620-Function-Analysis" class="headerlink" title="0x1620 Function Analysis"></a><code>0x1620</code> Function Analysis</h3><p><img data-src="/images/ost2/max_func.png" alt="Max value"></p>
<p>From the analysis of this function, it accepts two parameters of type <code>long</code> and finds the maximum value between the two. The two parameters are compared through use of <code>jge</code> assembly instruction as shown above.</p>
<h3 id="0x1342-Function-Analysis"><a href="#0x1342-Function-Analysis" class="headerlink" title="0x1342 Function Analysis"></a><code>0x1342</code> Function Analysis</h3><p><img data-src="/images/ost2/func3.png" alt="Max value"></p>
<p>The function accepts two parameters of type <code>long</code> and checks if one parameter is equal to <code>zero</code>. If the value is not equal to <code>zero</code>, it does math and bit operations.</p>
<h3 id="0x15fa-Function-Analysis"><a href="#0x15fa-Function-Analysis" class="headerlink" title="0x15fa Function Analysis"></a><code>0x15fa</code> Function Analysis</h3><p><img data-src="/images/ost2/max_value2.png" alt="Max value"></p>
<p>From the analysis of this function, function accepts two parameters of type <code>int</code> and finds the maximum value between the two. The two parameters are compared through use of <code>jge</code> assembly instruction. Therefore the maximum value is returned by the function.</p>
<h3 id="0x1245-Function-Analysis"><a href="#0x1245-Function-Analysis" class="headerlink" title="0x1245 Function Analysis"></a><code>0x1245</code> Function Analysis</h3><p><img data-src="/images/ost2/func4.png" alt="0x1245 analysis"></p>
<p>This function takes four parameters of type <code>int</code> and does further bits operations as shown in the disassembly code.</p>
<p>From the above functions analysis, only two functions qualify as templates. <code>0x1620</code> and <code>0x15fa</code> are templates functions because they perform the same functionality( <code>Finding the Maximum value</code>) and number of parameters passed to each function are the same.</p>
<h2 id="Question-2"><a href="#Question-2" class="headerlink" title="Question 2"></a>Question 2</h2><blockquote>
<p>Review the function at address <code>0x12C5</code> and other functions in the binary. Is this function a template function?</p>
</blockquote>
<h3 id="0x12C5-Function-Analysis"><a href="#0x12C5-Function-Analysis" class="headerlink" title="0x12C5 Function Analysis"></a><code>0x12C5</code> Function Analysis</h3><p><img data-src="/images/ost2/func5.png" alt="0x12c5 analysis"></p>
<p>This function does the same functionality as the function <code>0x1245</code>, but the difference is the unequal number of parameters passed to each function.<br>Therefore, it does <code>not</code> qualify as a template function.</p>
<h2 id="Question-3"><a href="#Question-3" class="headerlink" title="Question 3"></a>Question 3</h2><blockquote>
<p>Review the function at address <code>0x15cc</code> and the function at address <code>0x15fa</code>. Are these functions part of the same template function?</p>
</blockquote>
<h3 id="0x15cc-Function-Analysis"><a href="#0x15cc-Function-Analysis" class="headerlink" title="0x15cc Function Analysis"></a><code>0x15cc</code> Function Analysis</h3><p>This function is used for calculating minimum value of the two parameters passed to function.</p>
<p><img data-src="/images/ost2/min_value.png" alt="0x15cc analysis"></p>
<p>The two functions are <code>not</code> of the same template function. This is because one is used for calculating the maximum value and other one for minimum value. The difference between the two is <code>jge</code> and <code>jle</code> conditional assembly instructions as shown in IDA disassembly above.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li>C++ Templates Basics - <a target="_blank" rel="noopener" href="https://m.cplusplus.com/doc/oldtutorial/templates/">https://m.cplusplus.com/doc/oldtutorial/templates/</a></li>
</ol>

    </div>

    
    
    
      


    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/reverse/" rel="tag"># reverse</a>
              <a href="/tags/opensecurity/" rel="tag"># opensecurity</a>
              <a href="/tags/c/" rel="tag"># c++</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/04/20/Gopackets/" rel="prev" title="Gopackets library">
                  <i class="fa fa-chevron-left"></i> Gopackets library
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Thuri</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  





</body>
</html>
